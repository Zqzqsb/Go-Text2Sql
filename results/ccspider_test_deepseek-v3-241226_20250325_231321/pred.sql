SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-13' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) / 3600 > 15 AND d.name = '客户服务部';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-11' AND a.check_in > '09:00';
SELECT COUNT(*) FROM attendance_records WHERE employee_id = 'H03961' AND strftime('%Y', date) = '2024' AND time(check_in) > '09:00:00';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-24' AND a.check_in < '08:30' AND p.rating = 'A+';
SELECT e.name, d.name, a.check_in, a.check_out FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-10-05';
SELECT e.name, d.name, a.check_in, a.check_out FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-21' ORDER BY d.name;
SELECT ROUND(COUNT(CASE WHEN status = '离职' AND julianday(end_date) - julianday(start_date) < 90 THEN 1 END) * 1.0 / COUNT(*), 2) AS ratio FROM probation_employees;
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '客户服务部' AND a.date = '2024-10-08' AND a.check_in > '09:00';
SELECT e.name, e.hire_date FROM employees e JOIN probation_employees p ON e.employee_id = p.employee_id;
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00' AND e.remaining_annual_leave < 5;
SELECT e.employee_id, p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE YEAR(e.hire_date) = 2023 AND a.date = '2024-10-05';
SELECT p.rating FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE YEAR(e.hire_date) = 2023 AND a.date = '2024-09-26';
SELECT COUNT(*) FROM attendance_records WHERE employee_id = 'H05598' AND strftime('%Y', date) = '2024' AND check_out < '18:00';
SELECT e.name, d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-28' AND a.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '运营部' AND a.date = '2024-10-12' AND a.check_in > '09:00';
SELECT employees.name, departments.name FROM attendance_records JOIN employees ON attendance_records.employee_id = employees.employee_id JOIN departments ON employees.department_id = departments.department_id WHERE attendance_records.date = '2024-10-11' AND attendance_records.check_in > '09:00';
SELECT e.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-21' AND a.check_in > '09:00' AND d.name = '销售部';
SELECT e.name, d.name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-12-11' AND pe.rating = 'C';
SELECT e.employee_id, d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00';
SELECT a.employee_id FROM awards a INNER JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '创新奖' AND p.rating = 'A+';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-09' AND a.check_in > '08:30:00' AND d.name = '客户服务部';
SELECT COUNT(DISTINCT p.employee_id) FROM probation_employees p JOIN awards a ON p.employee_id = a.employee_id WHERE p.start_date <= '2023-12-31' AND p.end_date >= '2023-01-01' AND a.year = 2023 AND a.award_name = '优秀员工奖';
SELECT DISTINCT e.employee_id FROM employees e INNER JOIN awards a ON e.employee_id = a.employee_id WHERE YEAR(e.hire_date) = 2021 AND a.year = 2022;
SELECT employee_id FROM attendance_records GROUP BY employee_id, date HAVING COUNT(*) > 1;
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-24' AND a.check_in > '09:30' AND e.remaining_annual_leave < 10;
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.department_id = '销售部' AND a.date = '2024-09-19' AND a.check_in > '09:00';
SELECT DISTINCT d.name FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-26' AND a.check_in > '09:00' AND p.rating = 'C';
SELECT e.employee_id FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE YEAR(e.hire_date) = 2021 AND a.year = 2021 AND p.rating = 'B';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-03' AND a.check_in > '09:00' AND e.department_id = '销售部';
SELECT a.employee_id FROM awards a JOIN probation_employees p ON a.employee_id = p.employee_id WHERE a.year = 2020 AND a.award_name = '优秀员工' AND p.status = '试用期内';
SELECT e.employee_id FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE YEAR(e.hire_date) = 2023 AND a.year = 2023 AND p.rating = 'A+';
SELECT e.name, d.name, a.check_in, a.check_out FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id JOIN probation_employees p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-19' AND p.start_date <= '2024-09-19' AND p.end_date >= '2024-09-19';
SELECT employee_id, 20 - remaining_annual_leave AS used_annual_leave FROM employees;
SELECT DISTINCT e.employee_id FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2022 AND a.award_name = '技术突破奖' AND (ar.check_out - ar.check_in) > '10:00:00';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-20' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 28800 AND d.name = '质量控制部';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-09-25' AND a.check_in < '09:00';
SELECT e.name FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE pe.rating = 'A+' GROUP BY e.name ORDER BY AVG((strftime('%s', ar.check_out) - strftime('%s', ar.check_in)) / 3600.0) DESC LIMIT 1;
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-04' AND a.check_in > '09:00' AND e.department_id = '销售部';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-18' AND a.check_in > '09:00' AND p.rating = 'D';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-25' AND a.check_in > '08:30:00' AND p.rating = 'B+';
SELECT employee_id, interview_count FROM interviews WHERE YEAR(interview_date) = 2024 ORDER BY interview_count;
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-10' AND a.check_in > '08:30:00' AND p.rating = 'A+';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-27' AND a.check_in > '09:00' AND e.remaining_annual_leave < 10;
SELECT e.name, p.evaluation_date FROM employees e JOIN performance_evaluations p ON e.employee_id = p.employee_id;
SELECT e.name, d.name, a.check_in, a.check_out FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-10-07' AND a.check_in > '09:00' AND a.check_out < '17:00';
SELECT e.name, d.name, a.check_in, a.check_out FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-10-05';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN interviews i ON e.employee_id = i.employee_id GROUP BY d.name ORDER BY AVG(i.interview_count) DESC LIMIT 1;
SELECT DISTINCT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-27' AND p.rating = 'A+';
SELECT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2024 AND a.award_name = '最佳团队奖' AND ar.date = '2024-10-09' AND ar.check_in > '09:00';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-14' AND a.check_in > '09:00' AND e.department_id = (SELECT department_id FROM departments WHERE name = '质量控制部');
SELECT e.employee_id, e.name FROM employees e JOIN attendance_records ar ON e.employee_id = ar.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-09-24' AND ar.check_out > '13:00' AND pe.rating = 'B+';
SELECT e.employee_id, d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-08' AND a.check_in > '09:00';
SELECT employees.name, departments.name, awards.award_name FROM awards JOIN employees ON awards.employee_id = employees.employee_id JOIN departments ON employees.department_id = departments.department_id WHERE awards.year = 2022;
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-12' AND a.check_in > '09:00' AND p.rating = 'D';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-13' AND a.check_in < '09:30';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.department_id = (SELECT department_id FROM departments WHERE name = '客户服务部') AND a.date = '2024-09-22';
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '质量改进奖' AND p.rating = 'A+';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05' AND a.check_in > '08:30' AND d.manager_id = 'H05487';
SELECT e.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '行政部' AND a.date = '2024-10-02' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 32400;
SELECT d.name, e.name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-03-31' AND pe.rating = 'D';
SELECT name, car_plate FROM employees WHERE employee_type = '正式';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '质量控制部' AND a.date = '2024-09-19' AND a.check_in > '09:00:00';
SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2022 AND a.award_name = '客户满意度奖' AND ar.date = '2024-10-12' AND ar.check_in > '09:00:00';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-11' AND a.check_in > '09:00' AND d.manager_id = 'H00842';
SELECT e.name, d.name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.year = 2023 AND a.award_name = '领导力奖';
SELECT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '领导力奖' AND ar.date = '2024-10-09' AND ar.check_in > '09:00';
SELECT d.manager_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-02' AND a.check_in BETWEEN '09:00' AND '10:00' AND e.employee_type = '实习生';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id GROUP BY d.name ORDER BY AVG(DATEDIFF(CURDATE(), e.birth_date)) DESC LIMIT 1;
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-16' AND p.rating = 'C';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-08' AND a.check_in > '09:00' AND d.name = '研发部';
SELECT e.employee_id, e.name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '财务部' AND a.date = '2024-09-20' AND a.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 28800 AND d.name = '人力资源部';
SELECT DISTINCT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-14' AND p.rating = 'A+';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '行政部' AND a.date = '2024-09-27' AND a.check_in > '09:00';
SELECT d.name, COUNT(e.employee_id) FROM departments d LEFT JOIN employees e ON d.department_id = e.department_id GROUP BY d.name;
SELECT e.name FROM employees e JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE p.rating = 'A+' ORDER BY e.hire_date LIMIT 1;
SELECT employee_id FROM (SELECT e.employee_id, ABS(SUM(STRFTIME('%s', a.check_out) - STRFTIME('%s', a.check_in)) - AVG(SUM(STRFTIME('%s', a.check_out) - STRFTIME('%s', a.check_in))) OVER (PARTITION BY e.department_id)) AS diff FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id GROUP BY e.employee_id) ORDER BY diff DESC LIMIT 1;
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '研发部' AND a.date = '2024-10-05' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 36000;
SELECT e.name, d.name, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-12';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '销售部' AND a.date = '2024-10-11' AND a.check_in > '09:00';
SELECT e.name, d.name, a.check_in, aw.award_name FROM attendance_records a JOIN awards aw ON a.employee_id = aw.employee_id AND a.date = aw.year || '-09-26' JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-26' AND a.check_in > '09:00';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-05' AND a.check_in > '09:00' AND p.rating = 'A+';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-07' AND a.check_in > '09:00' AND d.name = '人力资源部';
SELECT e.name, d.name, a.check_in FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-10-11' AND e.employee_type = '实习生' AND a.check_in < '09:00';
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '优秀员工奖' AND p.rating = 'A+';
SELECT d.name, COUNT(DISTINCT e.employee_id) FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE pe.evaluation_date >= DATE_SUB(CURDATE(), INTERVAL 5 YEAR) AND pe.rating = '高' AND e.position IN ('经理', '高级职位') GROUP BY d.name;
SELECT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2024 AND a.award_name = '新人奖' AND ar.date = '2024-10-08';
SELECT ar.employee_id FROM attendance_records ar JOIN performance_evaluations pe ON ar.employee_id = pe.employee_id WHERE ar.date = '2024-10-02' AND ar.check_in > '09:00' AND pe.rating = 'A+';
SELECT e.name, d.name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.year = 2024 AND a.award_name = '新人奖';
SELECT AVG(JULIANDAY(start_work_date) - JULIANDAY(hire_date)) FROM employees WHERE position LIKE '%管理%';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '研发部' AND a.date = '2024-10-06' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 36000;
SELECT DISTINCT a.employee_id FROM awards a INNER JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '技术突破奖' AND p.rating = 'A+';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-17' AND a.check_in > '09:00:00' AND p.rating = 'D';
SELECT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2024 AND a.award_name = '项目管理奖' AND ar.date = '2024-10-03';
SELECT a.employee_id FROM awards a JOIN employees e ON a.employee_id = e.employee_id WHERE a.year = 2023 AND a.award_name = '领导力奖' AND e.hire_date > '2017-01-01';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-09-16' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 28800;
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '领导力奖' AND p.evaluation_date = '2023-06-04' AND p.rating = 'D';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '客户服务部' AND a.date = '2024-10-12' AND a.check_in > '09:00';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-21' AND a.check_in > '09:00:00' AND p.rating = 'B';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-24' AND a.check_in > '09:00' AND p.rating = 'C';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-05' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 32400 AND d.name = '行政部';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '财务部' AND a.date = '2024-10-06' AND a.check_in > '09:00';
SELECT e.name AS employee_name, m.name AS manager_name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN employees m ON d.manager_id = m.employee_id WHERE pe.rating = 'A+' AND strftime('%Y', pe.evaluation_date) = '2023';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-28' AND a.check_in > '09:00' AND p.rating = 'A';
SELECT attendance_records.* FROM attendance_records INNER JOIN awards ON attendance_records.employee_id = awards.employee_id WHERE awards.year = 2023 AND awards.award_name = '销售冠军' AND attendance_records.date = '2024-10-01';
SELECT e.employee_id FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE pe.rating = 'A+' GROUP BY e.department_id, e.employee_id ORDER BY MIN(JULIANDAY(pe.evaluation_date) - JULIANDAY(e.hire_date)) LIMIT 1;
SELECT d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00';
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.award_name = '优秀员工' AND a.year = 2024 AND p.rating = 'A+';
SELECT e.name, d.name, p.rating FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE p.evaluation_date = '2023-10-29';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-09-17' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 32400;
SELECT d.name FROM performance_evaluations pe JOIN employees e ON pe.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2022-06-16' AND pe.rating = 'C';
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2022 AND a.award_name = '优秀员工' AND p.evaluation_date = '2022-10-30' AND p.rating = 'A+';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-15' AND a.check_in > '09:00' AND p.rating = 'B';
SELECT name, position FROM employees WHERE department_id = '销售部';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-23' AND a.check_in > '09:00' AND p.rating = 'D';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE d.name = '客户服务部' AND p.rating = 'D' AND p.evaluation_date = '2024-10-14';
SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id WHERE a.year = 2023 AND a.award_name = '领导力奖' AND e.hire_date >= '2019-01-01';
SELECT DISTINCT e.department_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-09-20' AND a.check_in > '09:00' AND p.rating = 'A+';
SELECT e.employee_id, e.name FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id JOIN awards a ON e.employee_id = a.employee_id WHERE pe.rating = '一般' AND a.award_name IN ('最佳团队贡献奖', '最佳同事评价奖');
SELECT attendance_records.employee_id FROM attendance_records JOIN performance_evaluations ON attendance_records.employee_id = performance_evaluations.employee_id WHERE attendance_records.date = '2024-09-20' AND attendance_records.check_in BETWEEN '08:00' AND '09:00' AND performance_evaluations.rating = 'B';
SELECT e.employee_id, e.name FROM employees e JOIN (SELECT employee_id, MAX(evaluation_date) AS last_eval_date FROM performance_evaluations GROUP BY employee_id) pe ON e.employee_id = pe.employee_id JOIN performance_evaluations p ON pe.employee_id = p.employee_id AND pe.last_eval_date = p.evaluation_date WHERE p.evaluation_date < '2024-01-01' AND p.rating = 'B';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-19' AND a.check_in > '09:00' AND p.rating = 'B+';
SELECT d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-24' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 12 * 3600;
SELECT e.name FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-09-29' AND a.check_in < '09:00';
SELECT ar.employee_id FROM attendance_records ar JOIN performance_evaluations pe ON ar.employee_id = pe.employee_id WHERE ar.date = '2024-10-11' AND ar.check_in > '09:00' AND pe.rating = 'A';
SELECT date, check_in, check_out FROM attendance_records WHERE employee_id = 'H03961';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '厦门大学' AND a.date = '2024-09-23' AND a.check_in > '09:00';
SELECT a.employee_id FROM attendance_records a INNER JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-19' AND a.check_in > '09:00' AND p.rating = 'D';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-11' AND a.check_in > '08:30';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-10' AND a.check_in > '09:00' AND p.rating = 'D';
SELECT e.employee_id, e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE YEAR(e.hire_date) = 2024 AND a.year = 2024 AND a.award_name = '新人奖' AND p.rating = 'A';
SELECT DISTINCT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-26' AND a.check_in BETWEEN '08:00' AND '09:00' AND p.rating = 'B+';
SELECT DISTINCT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '创新奖' AND ar.date = '2024-09-25';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-24' AND a.check_in > '09:00' AND p.rating = 'D';
SELECT d.department_id, AVG(e.remaining_annual_leave) FROM departments d JOIN employees e ON d.department_id = e.department_id WHERE d.manager_id = 'H03372' GROUP BY d.department_id;
SELECT DISTINCT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-12' AND p.rating = 'A+';
SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '质量改进奖' AND ar.date = '2024-10-03' AND ar.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE d.name = '财务部' AND p.rating = 'A+' AND p.evaluation_date = '2024-09-15';
SELECT e.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-21' AND a.check_in > '09:00' AND d.name = '质量控制部';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '销售部' AND a.date = '2024-09-25' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 28800;
SELECT DISTINCT p.employee_id, p.rating FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2022 AND a.award_name = '技术突破奖' AND p.evaluation_date > '2022-07-13';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '财务部' AND a.date = '2024-10-11' AND a.check_in > '09:00';
SELECT e.name FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '研发部' AND a.date = '2024-10-12' AND a.check_in > '09:00';
SELECT DISTINCT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE p.evaluation_date = '2023-08-06' AND p.rating = 'C';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-10-01' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 43200;
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-09' AND a.check_in > '09:00' AND p.rating = 'A+';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '人力资源部' AND a.date = '2024-09-24' AND a.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '销售部' AND a.date = '2024-10-02' AND a.check_in > '09:00';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-11' AND a.check_out > '21:00' AND p.rating = 'B+';
SELECT e.name, d.name, e.hire_date FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE YEAR(p.evaluation_date) = 2022 AND p.rating = 'B' ORDER BY e.hire_date;
SELECT e.name, d.name, a.check_in, a.check_out FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '客户服务部' AND a.date = '2024-09-22';
SELECT DISTINCT d.name FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-20' AND a.check_in > '09:00' AND p.rating = 'B';
SELECT e.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-02' ORDER BY a.check_in ASC LIMIT 1;
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE YEAR(e.hire_date) = 2023 AND a.date = '2024-10-10' AND p.rating = 'B+';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '财务部' AND a.date = '2024-10-04' AND a.check_in > '09:00';
SELECT DISTINCT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-17' AND p.rating = 'A+';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN (SELECT employee_id FROM probation_employees GROUP BY employee_id ORDER BY COUNT(*) DESC LIMIT 3) pe ON e.employee_id = pe.employee_id;
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '财务部' AND a.date = '2024-10-04' AND a.check_in > '09:00';
SELECT e.name, d.name FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.year = 2023 AND a.award_name = '优秀员工';
SELECT COUNT(DISTINCT p.employee_id) FROM probation_employees p JOIN awards a ON p.employee_id = a.employee_id WHERE a.year = 2023 AND a.award_name = '客户满意度奖' AND p.start_date <= '2023-12-31' AND p.end_date >= '2023-01-01';
SELECT DISTINCT a.employee_id FROM attendance_records a INNER JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-24' AND a.check_in > '09:00:00' AND p.rating = 'C';
SELECT e.name, a.award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id;
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '法务部' AND a.date = '2024-10-13' AND a.check_in < '08:30';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '质量控制部' AND a.date = '2024-09-17' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 32400;
SELECT e.name, d.name, a.check_in, a.check_out FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-26' AND e.remaining_annual_leave > 10;
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '财务部' AND a.date = '2024-10-09' AND a.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '客户服务部' AND a.date = '2024-10-10' AND a.check_in > '09:00';
SELECT employee_id FROM performance_evaluations WHERE rating = '优秀';
SELECT e.employee_id, d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-25' AND a.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE d.name = '客户服务部' AND p.rating = 'A+' AND p.evaluation_date = '2024-09-28';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-07' AND a.check_in > '09:00' AND d.name = '法务部';
SELECT employees.name, departments.name, attendance_records.check_in, attendance_records.check_out FROM attendance_records JOIN employees ON attendance_records.employee_id = employees.employee_id JOIN departments ON employees.department_id = departments.department_id WHERE attendance_records.date = '2024-10-14';
SELECT DISTINCT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2021 AND a.award_name = '优秀员工' AND ar.date > '2021-01-01';
SELECT AVG(e.remaining_annual_leave) FROM employees e JOIN awards a ON e.employee_id = a.employee_id WHERE a.award_name = '领导力奖' AND a.year = 2024 AND e.hire_date > '2017-12-31';
SELECT e.employee_id FROM employees e JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE pe.rating = '优秀' AND e.university IS NULL AND e.major IS NULL AND e.position = '普通员工';
SELECT d.name FROM performance_evaluations p JOIN employees e ON p.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE p.evaluation_date = '2023-12-07' AND p.rating = 'B';
SELECT e.name, d.name, a.award_name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE YEAR(e.hire_date) = 2023 AND a.year = 2023;
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '销售部' AND a.date = '2024-09-25' AND a.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.department_id = '质量控制部' AND a.date = '2024-09-20' AND a.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '客户服务部' AND a.date = '2024-09-29' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) / 3600 > 10;
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-10-04' AND a.check_in > '08:30' AND p.rating = 'A+';
SELECT employee_id, COUNT(*) AS late_days FROM attendance_records WHERE check_in > '09:00' GROUP BY employee_id;
SELECT a.employee_id FROM attendance_records a INNER JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-15' AND p.rating = 'A+';
SELECT employee_id FROM attendance_records WHERE date = '2024-09-19' AND employee_id IN (SELECT employee_id FROM awards WHERE year = 2021 AND award_name = '最佳团队奖');
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-21' AND e.department_id = (SELECT department_id FROM departments WHERE name = '客户服务部');
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '财务部' AND a.date = '2024-09-23' AND a.check_in < '09:30';
SELECT a.employee_id, a.check_in FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-09' AND a.check_in > '09:00' AND e.employee_type = '实习生';
SELECT DISTINCT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '项目管理奖' AND ar.date = '2024-09-23';
SELECT e.employee_id FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE YEAR(e.hire_date) = 2022 AND a.year = 2023 AND p.rating = 'A+';
SELECT e.name, d.name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-13' AND d.name = '人力资源部';
SELECT e.name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '行政部' AND a.date = '2024-09-18' AND a.check_in > '09:00';
SELECT NULL;
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-20' AND a.check_in > '08:00:00' AND d.name = '销售部';
SELECT e.name, d.name FROM employees e JOIN departments d ON e.department_id = d.department_id WHERE (e.department_id, e.birth_date) IN (SELECT department_id, MIN(birth_date) FROM employees GROUP BY department_id);
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '人力资源部' AND a.date = '2024-09-30' AND a.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '研发部' AND a.date = '2024-09-18' AND a.check_in > '09:00';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-28' AND a.check_in > '09:30' AND p.rating = 'A+';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-17' AND a.check_in > '09:00' AND p.rating = 'B';
SELECT DISTINCT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-22' AND p.rating = 'D';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-03' AND p.rating = 'A+';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-07' AND a.check_in > '09:00' AND d.name = '客户服务部';
SELECT a.employee_id, a.date, a.check_in, a.check_out, p.rating FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id;
SELECT DISTINCT a.employee_id FROM attendance_records a INNER JOIN awards b ON a.employee_id = b.employee_id WHERE a.date = '2024-10-05' AND a.check_in > '09:00' AND b.year = 2021;
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '质量控制部' AND a.date = '2024-09-25' AND a.check_in > '08:30:00';
SELECT CASE WHEN COUNT(DISTINCT q.employee_id) = COUNT(DISTINCT a.employee_id) THEN '是' ELSE '否' END AS result FROM (SELECT employee_id, ROW_NUMBER() OVER (PARTITION BY YEAR(evaluation_date), QUARTER(evaluation_date) ORDER BY rating DESC) AS rn FROM performance_evaluations WHERE YEAR(evaluation_date) >= YEAR(CURDATE()) - 3) q JOIN (SELECT employee_id, ROW_NUMBER() OVER (PARTITION BY YEAR(date), QUARTER(date) ORDER BY ABS(TIMESTAMPDIFF(MINUTE, STR_TO_DATE(check_in, '%H:%i'), STR_TO_DATE(check_out, '%H:%i')) - 8*60) ASC) AS rn FROM attendance_records WHERE YEAR(date) >= YEAR(CURDATE()) - 3) a ON q.employee_id = a.employee_id AND q.rn = 1 AND a.rn = 1;
SELECT DISTINCT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND p.rating = 'A+';
SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2022 AND a.award_name = '质量改进奖' AND ar.date = '2024-10-04' AND ar.check_in > '09:00:00';
SELECT e.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-03' AND a.check_in > '09:00' AND e.department_id = '客户服务部';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '人力资源部' AND a.date = '2024-10-02' AND a.check_in > '09:00';
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '优秀员工' AND p.rating = 'A+';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE p.evaluation_date = '2023-05-31' AND p.rating = 'A+';
SELECT e.name FROM employees e JOIN attendance_records ar ON e.employee_id = ar.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-10-02' AND ar.check_in > '09:00' AND pe.rating = 'A+';
SELECT * FROM attendance_records WHERE date = '2024-09-18' AND employee_id IN (SELECT employee_id FROM awards WHERE year = 2021 AND award_name = '销售冠军');
SELECT employees.name, departments.name FROM performance_evaluations JOIN employees ON performance_evaluations.employee_id = employees.employee_id JOIN departments ON employees.department_id = departments.department_id WHERE performance_evaluations.evaluation_date = '2023-05-27' AND performance_evaluations.rating = 'A+';
SELECT d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-16' AND a.check_in > '09:00';
SELECT e.name, d.name FROM employees e JOIN departments d ON e.department_id = d.department_id;
SELECT name FROM employees ORDER BY hire_date ASC, position ASC LIMIT 1;
SELECT e.employee_id FROM employees e JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE e.department_id = 'D00007' AND p.rating = 'A' AND strftime('%Y', p.evaluation_date) = '2024';
SELECT DISTINCT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2022 AND a.award_name = '创新奖' AND ar.date = '2024-10-12' AND ar.check_in > '09:00';
SELECT d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-23' AND a.check_in > '09:00';
SELECT COUNT(DISTINCT a.employee_id) FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '质量改进奖' AND p.rating = 'A+';
SELECT DISTINCT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-23' AND a.check_in > '08:00' AND a.check_out < '18:00';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN awards a ON e.employee_id = a.employee_id WHERE a.award_name = '优秀员工奖' AND a.year = 2023;
SELECT e.name FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-10-12' AND a.check_in < '09:00:00' AND p.rating = 'B+';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-20' AND a.check_in > '09:00:00' AND p.rating = 'A+';
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2021 AND a.award_name = '质量改进奖' AND p.rating = 'B+';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-09-29' AND a.check_in > '08:30:00' AND e.department_id = '客户服务部';
SELECT d.manager_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-16' AND a.check_in > '08:30:00';
SELECT a.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id WHERE a.date = '2024-10-01' AND a.check_in > '09:00' AND e.position = '顾问';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '客户服务部' AND a.date = '2024-09-23' AND a.check_in > '09:00';
SELECT e.employee_id, e.name, a.year, p.rating FROM awards a JOIN employees e ON a.employee_id = e.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.award_name = '技术创新奖' AND a.year >= YEAR(CURDATE()) - 5;
SELECT e.employee_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-06' AND a.check_in > '09:00' AND d.name = '财务部';
SELECT e.name, d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-04' AND a.check_in > '09:00';
SELECT e.name, d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-04';
SELECT a.employee_id, a.award_name, p.rating, p.evaluation_date FROM awards a INNER JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND YEAR(p.evaluation_date) = 2023;
SELECT e.name, d.name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-10-10' AND a.check_in > '09:30';
SELECT e.name, d.name, a.check_in, a.check_out FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE a.date = '2024-09-19';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '行政部' AND a.date = '2024-10-03' AND a.check_in > '09:00';
SELECT name FROM departments WHERE id = (SELECT department_id FROM employees GROUP BY department_id ORDER BY AVG(remaining_annual_leave) DESC LIMIT 1);
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-27' AND a.check_in < '10:00' AND p.rating = 'A+';
SELECT interview_date, interview_count FROM interviews WHERE YEAR(interview_date) = 2024;
SELECT d.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-20' AND a.check_in > '09:00:00';
SELECT e.name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE d.name = '研发部' AND p.rating = 'B+' AND p.evaluation_date = '2024-09-29';
SELECT check_in, check_out FROM attendance_records WHERE employee_id IN (SELECT employee_id FROM awards WHERE year = 2022 AND award_name = '销售冠军') AND date = '2024-10-10';
SELECT employees.employee_id FROM employees JOIN awards ON employees.employee_id = awards.employee_id WHERE awards.year = 2023 AND awards.award_name = '客户满意度奖' AND employees.hire_date > '2020-06-19';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-22' AND a.check_in > '09:00' AND p.rating = 'A+';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE p.evaluation_date = '2022-06-20' AND p.rating = 'C';
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2024 AND a.award_name = '客户满意度奖' AND p.rating = 'C';
SELECT e.employee_id FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '项目管理奖' GROUP BY e.employee_id HAVING AVG((strftime('%s', ar.check_out) - strftime('%s', ar.check_in)) / 3600.0) > 10;
SELECT d.name FROM performance_evaluations pe INNER JOIN employees e ON pe.employee_id = e.employee_id INNER JOIN departments d ON e.department_id = d.department_id WHERE pe.evaluation_date = '2023-03-09' AND pe.rating = 'D';
SELECT e.name, p.rating, a.award_name FROM employees e JOIN performance_evaluations p ON e.employee_id = p.employee_id LEFT JOIN awards a ON e.employee_id = a.employee_id WHERE e.position LIKE '%专家%';
SELECT e.name, d.name, a.check_in, a.check_out FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-10-08';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '人力资源部' AND a.date = '2024-09-26' AND a.check_in > '09:00';
SELECT a.employee_id FROM attendance_records a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.date = '2024-09-28' AND a.check_in > '09:00' AND p.rating = 'A+';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '研发部' AND a.date = '2024-09-20' AND a.check_in > '09:00';
SELECT d.name FROM departments d JOIN employees e ON d.department_id = e.department_id JOIN attendance_records ar ON e.employee_id = ar.employee_id JOIN performance_evaluations pe ON e.employee_id = pe.employee_id WHERE ar.date = '2024-10-13' AND ar.check_in > '09:00' AND pe.rating = 'A+';
SELECT a.employee_id FROM awards a INNER JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2023 AND a.award_name = '销售冠军' AND p.rating IN ('A', 'B');
SELECT e.name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '财务部' AND a.date = '2024-09-17' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 32400;
SELECT d.manager_id FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE a.date = '2024-09-18' AND a.check_in > '09:00';
SELECT e.name FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN attendance_records ar ON e.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '技术突破奖' AND ar.date = '2024-09-23' AND ar.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '运营部' AND a.date = '2024-09-26';
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2020 AND a.award_name = '优秀员工' AND YEAR(p.evaluation_date) = 2023 AND p.rating = 'C';
SELECT e.name FROM employees e WHERE e.employee_id IN (SELECT a.employee_id FROM attendance_records a WHERE a.date = '2024-10-03' AND a.check_in > '09:00') AND e.employee_id IN (SELECT p.employee_id FROM performance_evaluations p WHERE p.rating = 'C');
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '法务部' AND a.date = '2024-10-12' AND a.check_in > '09:00';
SELECT d.name, YEAR(i.interview_date) AS year FROM interviews i JOIN employees e ON i.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE YEAR(i.interview_date) >= YEAR(CURDATE()) - 5 GROUP BY d.name, YEAR(i.interview_date) ORDER BY COUNT(DISTINCT e.employee_id) / COUNT(DISTINCT i.employee_id) DESC LIMIT 1;
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id WHERE e.university = '清华大学' AND a.date = '2024-10-12';
SELECT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '领导力奖' AND ar.date = '2024-10-01' AND ar.check_in > '09:00';
SELECT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2023 AND a.award_name = '销售冠军' AND ar.date = '2024-09-22' AND ar.check_in > '09:00:00';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '人力资源部' AND a.date = '2024-10-10' AND a.check_in > '09:00';
SELECT d.name FROM performance_evaluations p JOIN employees e ON p.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id WHERE p.evaluation_date = '2023-04-20' AND p.rating = 'D';
SELECT COUNT(DISTINCT e.employee_id) * 1.0 / (SELECT COUNT(*) FROM employees) FROM (SELECT employee_id FROM awards WHERE year >= YEAR(CURDATE()) - 1 INTERSECT SELECT employee_id FROM performance_evaluations WHERE evaluation_date >= DATE_SUB(CURDATE(), INTERVAL 2 YEAR)) AS e;
SELECT e.employee_id FROM employees e JOIN awards a ON e.employee_id = a.employee_id JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE YEAR(e.hire_date) = 2023 AND a.year = 2023 AND a.award_name = '优秀员工奖' AND p.rating = 'A+';
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '客户服务部' AND a.date = '2024-09-21' AND a.check_in > '09:00';
SELECT employee_id, SUM(STRFTIME('%s', check_out) - STRFTIME('%s', check_in)) AS total_work_duration FROM attendance_records GROUP BY employee_id;
SELECT e.employee_id FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '客户服务部' AND a.date = '2024-09-15' AND a.check_in > '09:00';
SELECT a.employee_id FROM awards a JOIN attendance_records ar ON a.employee_id = ar.employee_id WHERE a.year = 2021 AND a.award_name = '创新奖' AND ar.date = '2024-10-05' AND ar.check_in > '09:00';
SELECT a.employee_id FROM awards a INNER JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2024 AND p.rating = 'C';
SELECT a.employee_id FROM awards a JOIN performance_evaluations p ON a.employee_id = p.employee_id WHERE a.year = 2024 AND a.award_name = '领导力奖' AND p.rating = 'C';
SELECT e.employee_id, e.name FROM employees e JOIN departments d ON e.department_id = d.department_id JOIN attendance_records a ON e.employee_id = a.employee_id WHERE d.name = '质量控制部' AND a.date = '2024-09-19' AND a.check_in > '09:00';
SELECT employee_id FROM attendance_records WHERE date = '2024-09-23' AND employee_id IN (SELECT employee_id FROM awards WHERE year = 2024 AND award_name = '项目管理奖');
SELECT e.name, d.name, p.rating FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id LEFT JOIN performance_evaluations p ON e.employee_id = p.employee_id WHERE a.date = '2024-09-20';
SELECT e.name, m.name FROM attendance_records a JOIN employees e ON a.employee_id = e.employee_id JOIN departments d ON e.department_id = d.department_id JOIN employees m ON d.manager_id = m.employee_id WHERE a.date = '2024-09-26' AND a.check_in > '09:30:00';
SELECT employees.employee_id FROM employees INNER JOIN attendance_records ON employees.employee_id = attendance_records.employee_id WHERE employees.university = '清华大学' AND attendance_records.date = '2024-10-03' AND attendance_records.check_in > '09:00';
SELECT e.employee_id FROM employees e JOIN attendance_records a ON e.employee_id = a.employee_id JOIN departments d ON e.department_id = d.department_id WHERE d.name = '研发部' AND a.date = '2024-10-01' AND (strftime('%s', a.check_out) - strftime('%s', a.check_in)) > 36000;
SELECT DISTINCT p.employee_id, p.rating FROM performance_evaluations p JOIN awards a ON p.employee_id = a.employee_id WHERE a.year = 2023 AND a.award_name = '优秀员工' AND YEAR(p.evaluation_date) = 2023;
SELECT d.cust_no, d.acct_bal, l.loan_balance, l.loan_type FROM deposit_account_info d JOIN loan_detail_info l ON d.cust_no = l.cust_id WHERE d.data_dt = '2024-07-19' AND d.acct_bal > 100000 AND l.loan_balance > 500000;
SELECT cust_no FROM financial_products WHERE currency = '美元' AND wealth_bal > 5000000 AND data_dt = '2024-07-02';
SELECT rs_type_name, rs_type_id FROM five_level_classification WHERE rs_type = '不良' AND data_dt = '2024-07-22';
SELECT c.customer_name, o.occupation_name, lr.description FROM customer c JOIN occupation o ON c.occupation_id = o.id JOIN loan_repayment lr ON c.id = lr.loan_application_id ORDER BY lr.repayment_amount DESC;
SELECT c.customer_name, c.id_number, c.phone_number, c.email, c.address FROM customer c JOIN occupation o ON c.occupation_id = o.id WHERE o.occupation_name = '护士' ORDER BY c.customer_name;
SELECT COUNT(DISTINCT d.cust_no) FROM deposit_account_info d JOIN loan_detail_info l ON d.cust_no = l.cust_id JOIN bank_orgnization b ON d.bank_no = b.bank_id WHERE b.bank_name = '沈阳分行' AND d.cust_type = '对私' AND l.cust_type = '对私' AND d.data_dt = '2024-07-19' AND l.dw_date = '2024-07-19';
SELECT curr_code, curr_full_name, bank_name, bank_level FROM currency, bank_orgnization WHERE currency.data_dt = '2023-06-30' AND bank_orgnization.data_dt = '2023-06-30';
SELECT deposit_id, deposit_name FROM deposit_type WHERE data_dt = '2024-07-22';
SELECT cust_nm, residential_address FROM debit_card_information WHERE open_date = '2024-07-15' AND current_bal > 2000;
SELECT customer_id, credit_score FROM loan_credit WHERE credit_date = '2003-06-22' AND credit_score > 0.75;
SELECT c.customer_name, c.gender, SUM(lr.repayment_amount) FROM customer c JOIN loan_application la ON c.id = la.customer_id JOIN loan_repayment lr ON la.id = lr.loan_application_id GROUP BY c.gender;
SELECT c.* FROM customer c JOIN loan_application la ON c.id = la.customer_id ORDER BY la.loan_amount DESC LIMIT 1;
SELECT COUNT(DISTINCT fp.cust_no) FROM financial_products fp JOIN debit_card_information dci ON fp.cust_no = dci.cust_no WHERE fp.wealth_bal > 1000000 AND dci.card_state = '正常';
SELECT cust_no FROM deposit_account_info WHERE data_dt = '2024-07-19' AND org_nm = '沈阳余淮支行' AND acct_type_code = '活期存款' AND act_mon_avg_bal > 50000;
SELECT c.customer_name, l.loan_amount FROM loan_application l JOIN customer c ON l.customer_id = c.id WHERE l.loan_amount > 30000 AND l.status = 'PENDING';
SELECT acct_type_code, COUNT(DISTINCT cust_no) FROM deposit_account_info WHERE cust_no IN (SELECT customer_id FROM loan_application ORDER BY loan_amount DESC LIMIT 20) GROUP BY acct_type_code;
SELECT curr_code, curr_full_name FROM currency WHERE curr_class = '外币' ORDER BY curr_code ASC;
SELECT customer_id, loan_amount FROM loan_application ORDER BY loan_amount DESC;
SELECT cast_type, AVG(wealth_t_m_avg_bal_a) FROM financial_products WHERE data_dt LIKE '2024-07%' GROUP BY cast_type;
SELECT * FROM loan_detail_info WHERE loandate_s > '2024-04-01';
SELECT la.customer_id FROM loan_application la JOIN customer c ON la.customer_id = c.id WHERE la.loan_amount > (SELECT AVG(loan_amount) * 1.5 FROM loan_application la2 JOIN customer c2 ON la2.customer_id = c2.id WHERE CASE WHEN DATE_PART('year', AGE(c2.birth_date)) BETWEEN 0 AND 20 THEN '0-20' WHEN DATE_PART('year', AGE(c2.birth_date)) BETWEEN 21 AND 40 THEN '21-40' WHEN DATE_PART('year', AGE(c2.birth_date)) BETWEEN 41 AND 60 THEN '41-60' ELSE '61+' END = CASE WHEN DATE_PART('year', AGE(c.birth_date)) BETWEEN 0 AND 20 THEN '0-20' WHEN DATE_PART('year', AGE(c.birth_date)) BETWEEN 21 AND 40 THEN '21-40' WHEN DATE_PART('year', AGE(c.birth_date)) BETWEEN 41 AND 60 THEN '41-60' ELSE '61+' END);
SELECT birth_date, gender FROM customer;
SELECT cust_id FROM loan_detail_info WHERE loan_balance > 500000 AND loan_orgno = '沈阳分行' AND dw_date = '2024-07-19';
SELECT ldi.*, c.curr_full_name, flc.rs_type_name FROM loan_detail_info ldi JOIN currency c ON ldi.currency_type = c.curr_code JOIN five_level_classification flc ON ldi.judgelevel = flc.rs_type_id WHERE ldi.loan_balance > 1000000;
SELECT cust_id, curr_full_name FROM loan_detail_info JOIN currency ON loan_detail_info.currency_type = currency.curr_code WHERE loan_balance > 1000000 ORDER BY loan_balance DESC;
SELECT customer_id FROM user_behavior WHERE behavior_date >= DATEADD(year, -1, GETDATE()) GROUP BY customer_id ORDER BY COUNT(DISTINCT behavior_type) DESC LIMIT 5;
SELECT SUM(stm_overdu) AS 逾期金额总和, COUNT(DISTINCT custr_nbr) AS 账户数量 FROM credit_card_data WHERE corporation = 'Corp3' AND dw_date = '2024-07-03';
SELECT * FROM loan_detail_info WHERE cust_id = '1004';
SELECT c.*, t.* FROM customer c LEFT JOIN transfer t ON c.id = t.source_customer_id OR c.id = t.target_customer_id;
SELECT * FROM user_behavior JOIN loan_repayment ON user_behavior.customer_id = loan_repayment.customer_id;
SELECT cust_name, acct_bal, deposit_type_name FROM deposit_account_info JOIN deposit_type ON acct_type_code = deposit_id WHERE data_dt = '2024-07-21' AND acct_bal > 50000;
SELECT la.customer_id, (SUM(la.loan_amount) / p.province_total_loan) * 100 AS loan_percentage FROM loan_application la JOIN customer c ON la.customer_id = c.id JOIN (SELECT c.province, SUM(la.loan_amount) AS province_total_loan FROM loan_application la JOIN customer c ON la.customer_id = c.id GROUP BY c.province) p ON c.province = p.province GROUP BY la.customer_id, p.province_total_loan;
SELECT t1.province, t1.occupation_name FROM (SELECT c.province, o.occupation_name, COUNT(CASE WHEN la.status = '通过' THEN 1 END) * 1.0 / COUNT(*) AS pass_rate FROM customer c JOIN loan_application la ON c.id = la.customer_id JOIN occupation o ON c.occupation_id = o.id GROUP BY c.province, o.occupation_name) t1 JOIN (SELECT province, MAX(pass_rate) AS max_pass_rate FROM (SELECT c.province, o.occupation_name, COUNT(CASE WHEN la.status = '通过' THEN 1 END) * 1.0 / COUNT(*) AS pass_rate FROM customer c JOIN loan_application la ON c.id = la.customer_id JOIN occupation o ON c.occupation_id = o.id GROUP BY c.province, o.occupation_name) t2 GROUP BY province) t3 ON t1.province = t3.province AND t1.pass_rate = t3.max_pass_rate;
SELECT org_no, SUM(top10_bal) / total_bal AS ratio FROM (SELECT org_no, acct_bal, SUM(acct_bal) OVER (PARTITION BY org_no) AS total_bal, ROW_NUMBER() OVER (PARTITION BY org_no ORDER BY acct_bal DESC) AS rn FROM deposit_account_info) t WHERE rn <= 10 GROUP BY org_no, total_bal;
SELECT customer.customer_name, customer.phone_number FROM debit_card_information JOIN customer ON debit_card_information.cust_no = customer.id WHERE customer.customer_name LIKE '%Lee%';
SELECT c.id, c.customer_name, c.id_number, c.phone_number, c.email, c.address, c.birth_date, c.gender, c.occupation_id, c.province, ub.behavior_type, ub.behavior_date, ub.description AS behavior_description, lr.repayment_amount, lr.repayment_date, lr.description AS repayment_description FROM customer c LEFT JOIN user_behavior ub ON c.id = ub.customer_id LEFT JOIN loan_repayment lr ON c.id = lr.loan_application_id;
SELECT DISTINCT lc.customer_id FROM loan_credit lc JOIN loan_repayment lr ON lc.customer_id = lr.loan_application_id WHERE lc.credit_score > 0.75 AND lr.repayment_date = '2021-11-10';
SELECT * FROM loan_repayment WHERE repayment_amount > 900;
SELECT cust_no, cust_nm, card_no, residential_address FROM debit_card_information WHERE card_state = '正常' AND residential_address = '987 Willow Street' AND data_dt = '2024-07-09';
SELECT cust_id, loan_amount, loan_balance FROM loan_detail_info;
SELECT loan_type.loan_type_name, COUNT(DISTINCT debit_card_information.cust_no) AS user_count FROM loan_type JOIN loan_application ON loan_type.id = loan_application.loan_type_id JOIN debit_card_information ON loan_application.customer_id = debit_card_information.cust_no GROUP BY loan_type.loan_type_name;
SELECT loan_type_id, COUNT(DISTINCT customer_id) FROM loan_application GROUP BY loan_type_id;
SELECT credit_score, description FROM loan_credit WHERE credit_date = '2011-04-13';
SELECT SUM(wealth_bal) AS 理财余额总和, SUM(wealth_bal_f) AS 保本理财余额总和 FROM financial_products WHERE bank_nm = '沈阳余淮支行' AND data_dt = '2024-07-14';
SELECT customer_id, credit_score FROM loan_credit WHERE credit_date = '2003-06-22' AND credit_score > 0.75;
SELECT source_customer_id, target_customer_id FROM transfer;
SELECT loan_type_name FROM loan_type WHERE loan_type_code = 'MORTGAGE';
SELECT cust_nm, card_no FROM debit_card_information WHERE data_dt = '2024-07-05' AND card_state = '正常';
SELECT bank_nm, cast_type, COUNT(*) FROM financial_products GROUP BY bank_nm, cast_type;
SELECT deposit_name, deposit_type_id FROM deposit_type ORDER BY deposit_name;
SELECT status, loan_amount FROM loan_application;
SELECT c.* FROM customer c JOIN loan_credit lc ON c.id = lc.customer_id WHERE lc.credit_score = 0.77;
SELECT lt.loan_type_name, lt.description, lr.repayment_amount, lr.repayment_date FROM loan_type lt JOIN loan_application la ON lt.id = la.loan_type_id JOIN loan_repayment lr ON la.id = lr.loan_application_id;
SELECT rs_type_id, rs_type_name FROM five_level_classification;
SELECT card_no, closing_date FROM debit_card_information WHERE closing_date > '2024-07-05';
SELECT card_type, card_state FROM debit_card_information WHERE card_type IS NOT NULL;
SELECT cust_id, SUM(loan_balance) FROM loan_detail_info WHERE dw_date = '2024-07-19' AND loan_balance > 100000 GROUP BY cust_id;
SELECT CORR(d.acct_bal, l.loan_balance) AS correlation_coefficient FROM deposit_account_info d JOIN loan_detail_info l ON d.org_nm = l.loan_orgno;
SELECT DATE_FORMAT(t.transfer_date, '%Y-%m') AS month, SUM(t.transfer_amount) AS total_transfer, SUM(l.loan_amount) AS total_loan FROM transfer t LEFT JOIN loan_application l ON DATE_FORMAT(t.transfer_date, '%Y-%m') = DATE_FORMAT(l.apply_date, '%Y-%m') GROUP BY month;
SELECT customer_name, phone_number FROM customer WHERE province = '上海市';
SELECT credit_score, credit_date FROM loan_credit WHERE customer_id = 533302;
SELECT * FROM transfer ORDER BY transfer_amount DESC;
SELECT customer_id, COUNT(DISTINCT behavior_type) FROM user_behavior GROUP BY customer_id;
SELECT COUNT(DISTINCT d.cust_no) FROM deposit_account_info d JOIN credit_card_data c ON d.cust_no = c.custr_nbr WHERE d.data_dt = '2024-07-22' AND d.bank_nm = '沈阳分行' AND d.acct_bal > 100000 AND c.stm_overdu > 5000;
SELECT card_no, cust_nm FROM debit_card_information WHERE bank_nm = '北京分行';
SELECT COUNT(DISTINCT customer_id) FROM (SELECT customer_id, apply_date, LAG(apply_date, 1) OVER (PARTITION BY customer_id ORDER BY apply_date) AS prev1, LAG(apply_date, 2) OVER (PARTITION BY customer_id ORDER BY apply_date) AS prev2 FROM loan_application) t WHERE EXTRACT(YEAR FROM apply_date) = EXTRACT(YEAR FROM prev1) AND EXTRACT(MONTH FROM apply_date) = EXTRACT(MONTH FROM prev1) + 1 AND EXTRACT(YEAR FROM prev1) = EXTRACT(YEAR FROM prev2) AND EXTRACT(MONTH FROM prev1) = EXTRACT(MONTH FROM prev2) + 1;
SELECT cust_no, bank_nm FROM financial_products ORDER BY cust_no;
SELECT occupation_code, occupation_name FROM occupation ORDER BY occupation_name;
SELECT COUNT(DISTINCT fp.cust_no) FROM financial_products fp JOIN debit_card_information d ON fp.cust_no = d.cust_no WHERE fp.wealth_bal > d.current_bal * 10;
SELECT loan_orgno, loan_balance FROM loan_detail_info WHERE loan_amount > 70000;
SELECT lt.loan_type_name, ub.behavior_type FROM loan_type lt JOIN loan_application la ON lt.id = la.loan_type_id JOIN user_behavior ub ON la.customer_id = ub.customer_id;
SELECT bank_level, COUNT(*) FROM bank_orgnization GROUP BY bank_level;
SELECT current_bal, fixed_bal FROM debit_card_information WHERE data_dt = '2024-07-15' AND bank_nm = '北京东单支行' AND cust_nm = 'Olivia Lee';
SELECT c.customer_name, lc.description FROM customer c JOIN loan_credit lc ON c.id = lc.customer_id WHERE lc.credit_date = '2017-10-31' AND lc.credit_score > 0.85 ORDER BY lc.credit_score DESC;
SELECT loan_amount FROM loan_application WHERE loan_type_id = (SELECT id FROM loan_type WHERE loan_type_name = '汽车贷款');
SELECT loan_type_id, AVG(repayment_amount) AS avg_repayment_amount, COUNT(*) AS repayment_count FROM loan_repayment JOIN loan_application ON loan_repayment.loan_application_id = loan_application.id GROUP BY loan_type_id;
SELECT acc_name1, bank, category, day_opened FROM credit_card_data WHERE corporation = 'Corp3' ORDER BY day_opened DESC;
SELECT customer_name, address FROM customer;
SELECT l.loan_orgno, SUM(l.loan_amount) / SUM(d.current_bal) AS ratio FROM loan_detail_info l JOIN debit_card_information d ON l.loan_orgno = d.org_no WHERE YEAR(l.dw_date) = 2023 AND YEAR(d.data_dt) = 2023 GROUP BY l.loan_orgno;
SELECT * FROM loan_repayment ORDER BY ABS(repayment_amount - (SELECT AVG(repayment_amount) FROM loan_repayment)) LIMIT 1;
SELECT DISTINCT lc.customer_id FROM loan_credit lc JOIN financial_products fp ON lc.customer_id = fp.cust_no WHERE lc.credit_score > 0.8 AND strftime('%Y-%m', lc.credit_date) = '2024-07' AND strftime('%Y-%m', fp.data_dt) = '2024-07';
SELECT DATE_FORMAT(apply_date, '%Y-%m') AS month, COUNT(CASE WHEN status = 'APPROVED' THEN 1 END) / COUNT(*) AS approval_rate FROM loan_application GROUP BY DATE_FORMAT(apply_date, '%Y-%m');
SELECT b.bank_name, COUNT(DISTINCT c.id) AS new_customers, AVG(l.loan_amount) AS avg_loan_amount FROM customer c JOIN loan_application l ON c.id = l.customer_id JOIN bank_orgnization b ON c.province = b.bank_id WHERE c.birth_date BETWEEN '2024-01-01' AND '2024-03-31' GROUP BY b.bank_name;
SELECT bank_parent, AVG(loan_term) AS avg_loan_term, AVG(loan_amount) AS avg_loan_amount FROM bank_orgnization JOIN loan_application ON bank_orgnization.bank_id = loan_application.customer_id GROUP BY bank_parent;
SELECT credit_score, credit_date FROM loan_credit;
SELECT cust_id, loan_balance FROM loan_detail_info WHERE loandate_e < '2026-01-01';
SELECT id, apply_date FROM loan_application;
SELECT customer_id, loan_amount FROM loan_application la JOIN loan_type lt ON la.loan_type_id = lt.id WHERE lt.loan_type_name = '住房贷款' AND la.status = 'APPROVED' ORDER BY loan_amount DESC;
SELECT org_nm, bank_nm FROM deposit_account_info ORDER BY acct_bal DESC LIMIT 5;
SELECT * FROM loan_repayment WHERE description = '严琳';
SELECT rs_type_name, COUNT(*) FROM five_level_classification GROUP BY rs_type_name;
SELECT rs_type_name, COUNT(*) FROM five_level_classification GROUP BY rs_type_name;
SELECT b.bank_name, f.cust_no, f.wealth_bal FROM bank_orgnization b JOIN financial_products f ON b.bank_id = f.bank_no;
SELECT loan_type_name, description FROM loan_type ORDER BY loan_type_code;
SELECT bank_name, bank_parent FROM bank_orgnization WHERE bank_level = '2';
SELECT province, customer_name, loan_amount FROM (SELECT c.province, c.customer_name, la.loan_amount, ROW_NUMBER() OVER (PARTITION BY c.province ORDER BY la.loan_amount DESC) AS rn FROM customer c JOIN loan_application la ON c.id = la.customer_id) sub WHERE rn <= 3;
SELECT * FROM transfer WHERE source_customer_id = 376252;
SELECT customer.customer_name, customer.gender, occupation.occupation_name FROM customer JOIN occupation ON customer.occupation_id = occupation.id;
SELECT COUNT(DISTINCT cust_no), SUM(wealth_bal_f) FROM financial_products WHERE bank_nm = '沈阳余淮支行' AND data_dt = '2024-07';
SELECT customer_id FROM loan_credit WHERE credit_score > 0.8;
SELECT c1.customer_name AS source_customer_name, c2.customer_name AS target_customer_name, t.transfer_amount FROM transfer t JOIN customer c1 ON t.source_customer_id = c1.id JOIN customer c2 ON t.target_customer_id = c2.id WHERE t.transfer_amount > 5000;
SELECT DISTINCT customer_id FROM loan_application la INNER JOIN loan_status ls ON la.status = ls.loan_status_code WHERE ls.loan_status_name = 'APPROVED' AND YEAR(la.apply_date) = 2019;
SELECT category, COUNT(DISTINCT custr_nbr) AS customer_count, AVG(wealth_bal) AS avg_wealth_balance FROM credit_card_data JOIN financial_products ON credit_card_data.custr_nbr = financial_products.cust_no GROUP BY category;
SELECT c.customer_name, l.loan_amount FROM loan_application l JOIN customer c ON l.customer_id = c.id ORDER BY l.apply_date ASC;
SELECT SUM(acct_bal) AS 账户余额总和, SUM(act_year_avg_bal) AS 实际年日均余额总和 FROM deposit_account_info WHERE data_dt = '2024-07-19' AND cust_type = '对私';
SELECT c.occupation_id FROM loan_repayment lr JOIN loan_application la ON lr.loan_application_id = la.id JOIN customer c ON la.customer_id = c.id WHERE lr.repayment_amount < 500;
SELECT cust_no, cust_name, acct_bal FROM deposit_account_info WHERE data_dt = '2023-07-19';
SELECT * FROM loan_application WHERE customer_id = (SELECT cust_no FROM deposit_account_info ORDER BY acct_bal DESC LIMIT 1) ORDER BY apply_date DESC LIMIT 1;
SELECT occupation_id, COUNT(*) FROM customer GROUP BY occupation_id;
SELECT customer.customer_name, transfer.transfer_amount FROM transfer JOIN customer ON transfer.source_customer_id = customer.id WHERE transfer.transfer_date = '2016-06-11' AND transfer.transfer_amount > 5000 ORDER BY transfer.transfer_amount DESC;
SELECT ldi.cust_id, ldi.loan_balance, ldi.loan_type, c.curr_full_name FROM loan_detail_info ldi JOIN currency c ON ldi.currency_type = c.curr_code WHERE ldi.loandate_s > '2024-07-01' AND ldi.loan_balance > 1000000 ORDER BY ldi.loan_balance DESC;
SELECT * FROM user_behavior WHERE behavior_date = '2018-06-26';
SELECT * FROM loan_repayment WHERE DAYOFWEEK(repayment_date) IN (6, 7);
SELECT deposit_type.deposit_type_name, loan_type.loan_type_name, COUNT(DISTINCT customer.id) AS customer_count FROM deposit_account_info JOIN deposit_type ON deposit_account_info.acct_type_code = deposit_type.deposit_type_id JOIN customer ON deposit_account_info.cust_no = customer.id_number JOIN loan_application ON customer.id = loan_application.customer_id JOIN loan_type ON loan_application.loan_type_id = loan_type.id GROUP BY deposit_type.deposit_type_name, loan_type.loan_type_name ORDER BY customer_count DESC;
SELECT c.customer_name, lr.repayment_amount FROM loan_repayment lr JOIN customer c ON lr.customer_id = c.id WHERE lr.repayment_date = '2021-11-10' AND lr.repayment_amount > 20 ORDER BY lr.repayment_amount DESC;
SELECT loan_type_name, AVG(credit_score) FROM loan_type JOIN loan_application ON loan_type.id = loan_application.loan_type_id JOIN loan_credit ON loan_application.customer_id = loan_credit.customer_id GROUP BY loan_type_name;
SELECT loan_type_name, loan_type_code FROM loan_type WHERE loan_type_code IS NOT NULL;
SELECT status, COUNT(*) FROM loan_application GROUP BY status;
SELECT customer_id, description FROM loan_credit;
SELECT c.customer_name, c.id_number, c.phone_number, d.card_no, d.current_bal FROM customer c JOIN debit_card_information d ON c.id = d.cust_no WHERE d.org_nm = '北京东单支行' AND d.open_date = '2024-07-15';
SELECT cust_type, SUM(loan_amount) FROM loan_detail_info GROUP BY cust_type ORDER BY cust_type;
SELECT reportid FROM loan_detail_info ORDER BY (loan_balance / loan_amount) DESC LIMIT 10;
SELECT customer_id, SUM(loan_amount) FROM loan_application WHERE YEAR(apply_date) = 2019 AND status = 'REJECTED' AND loan_type_id = 1 GROUP BY customer_id;
SELECT * FROM bank_orgnization;
SELECT ldi.*, c.curr_full_name, flc.rs_type_name FROM loan_detail_info ldi JOIN currency c ON ldi.currency_type = c.curr_code JOIN five_level_classification flc ON ldi.judgelevel = flc.rs_type_id WHERE ldi.blc_capital > 10000 AND ldi.dw_date = '2024-07-22';
SELECT card_state, open_date FROM debit_card_information WHERE card_state = '正常';
SELECT c.customer_name, t.transfer_amount, t.transfer_date FROM transfer t JOIN customer c ON t.source_customer_id = c.id WHERE t.transfer_date = '2023-06-30' ORDER BY t.transfer_amount DESC;
SELECT bank_level, bank_name FROM bank_orgnization WHERE data_dt = '2023-06-30';
SELECT cust_no, SUM(wealth_bal) AS total_wealth_bal FROM financial_products WHERE data_dt = '2024-07-02' GROUP BY cust_no ORDER BY total_wealth_bal DESC;
SELECT SUM(loan_amount) FROM loan_application WHERE YEAR(apply_date) = 2019 AND status = 'REJECTED';
SELECT org_nm, SUM(acct_bal) FROM deposit_account_info WHERE data_dt = '2024-07-21' AND cust_type = '对公' AND bank_nm = '杭州分行' GROUP BY org_nm;
SELECT customer_id, SUM(repayment_amount) AS 还款总额, COUNT(behavior_type) AS 行为次数, AVG(repayment_amount) AS 平均还款金额 FROM loan_repayment JOIN user_behavior ON loan_repayment.customer_id = user_behavior.customer_id GROUP BY customer_id;
SELECT bank_name, bank_level, data_dt FROM bank_orgnization;
SELECT c.customer_name, d.acct_bal, o.occupation_name FROM deposit_account_info d JOIN customer c ON d.cust_no = c.id JOIN occupation o ON c.occupation_id = o.id LEFT JOIN loan_application l ON c.id = l.customer_id WHERE d.acct_bal IN (SELECT acct_bal FROM (SELECT acct_bal, NTILE(10) OVER (ORDER BY acct_bal DESC) AS percentile FROM deposit_account_info) t WHERE percentile = 1) AND l.id IS NULL;
SELECT loan_orgno, COUNT(CASE WHEN status = '已批准' THEN 1 END) * 1.0 / COUNT(*) AS success_rate FROM loan_detail_info GROUP BY loan_orgno;
SELECT cust_no, acct_bal FROM deposit_account_info WHERE data_dt LIKE '2023-07%';
SELECT bank_nm FROM deposit_account_info WHERE data_dt = '2023-06-30' AND acct_bal > 100000 AND cur_type = '美元';
SELECT dai.cust_name, dai.acct_type_code, dai.acct_bal, c.curr_full_name FROM deposit_account_info dai JOIN currency c ON dai.cur_type = c.curr_code WHERE dai.data_dt = '2024-07-19' AND dai.acct_bal > 100000;
SELECT cust_nm, card_no FROM debit_card_information WHERE card_state = '正常' AND open_date > '2024-07-01' ORDER BY open_date DESC;
SELECT deposit_name, deposit_type_id FROM deposit_type ORDER BY deposit_name;
SELECT source_customer_id, transfer_amount FROM (SELECT source_customer_id, transfer_amount, COUNT(*) AS cnt FROM transfer WHERE source_customer_id IN (SELECT source_customer_id FROM transfer GROUP BY source_customer_id ORDER BY COUNT(*) DESC LIMIT 10) GROUP BY source_customer_id, transfer_amount ORDER BY source_customer_id, cnt DESC) AS sub GROUP BY source_customer_id;
SELECT COUNT(DISTINCT c.id) AS customer_count, SUM(ldi.loan_balance) AS total_loan_balance FROM customer c JOIN credit_card_data ccd ON c.id = ccd.custr_nbr JOIN loan_detail_info ldi ON c.id = ldi.cust_id WHERE c.province = '上海市' AND ccd.acct_sts = '正常';
SELECT ldi.*, flc.rs_type_name, lt.loan_type_name FROM loan_detail_info ldi JOIN five_level_classification flc ON ldi.judgelevel = flc.rs_type_id JOIN loan_type lt ON ldi.loan_type = lt.loan_type_code WHERE ldi.dw_date = '2024-07-22' AND ldi.loan_balance > 15000;
SELECT COUNT(DISTINCT a.cust_id) FROM loan_detail_info a JOIN loan_detail_info b ON a.cust_id = b.cust_id WHERE a.loan_type = '房贷' AND b.loan_type = '车贷' AND a.loan_amount > b.loan_amount;
SELECT cust_no, cust_nm, SUM(current_bal) AS total_balance FROM debit_card_information WHERE org_nm = '杭州上城区支行' AND data_dt = '2024-07-19' GROUP BY cust_no, cust_nm ORDER BY total_balance DESC;
SELECT vouch_type, AVG(loan_amount) AS avg_loan_amount, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY loan_amount) AS median_loan_amount, PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY loan_amount) - PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY loan_amount) AS iqr_loan_amount FROM loan_detail_info GROUP BY vouch_type;
SELECT SUM(transfer_amount) FROM transfer WHERE transfer_date = '2020-11-03' AND source_customer_id IN (SELECT customer_id FROM loan_credit WHERE credit_score > 0.8) AND target_customer_id IN (SELECT customer_id FROM loan_credit WHERE credit_score > 0.8);
SELECT COUNT(DISTINCT la.customer_id) FROM loan_application la JOIN customer c ON la.customer_id = c.id JOIN occupation o ON c.occupation_id = o.id WHERE la.loan_amount > 50000 AND o.occupation_name = '护士';
SELECT c.*, l.* FROM loan_application l JOIN customer c ON l.customer_id = c.id WHERE l.apply_date >= '2024-07-01' AND l.apply_date < '2024-08-01';
SELECT TO_CHAR(apply_date, 'YYYY-MM') AS month, COUNT(CASE WHEN status = '通过' THEN 1 END) * 1.0 / COUNT(*) AS pass_rate FROM loan_application GROUP BY TO_CHAR(apply_date, 'YYYY-MM');
SELECT bank_nm, SUM(wealth_bal) FROM financial_products WHERE data_dt = '2024-07-02' AND cust_type = '对公客户' GROUP BY bank_nm;
SELECT c.id, c.customer_name, l.status FROM customer c JOIN loan_application l ON c.id = l.customer_id;
SELECT loan_type_id, COUNT(DISTINCT customer_id) AS customer_count, SUM(loan_amount) AS total_loan_amount FROM loan_application GROUP BY loan_type_id;
SELECT CASE WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) BETWEEN 0 AND 20 THEN '0-20' WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) BETWEEN 21 AND 40 THEN '21-40' WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) BETWEEN 41 AND 60 THEN '41-60' ELSE '61+' END AS age_group, SUM(CASE WHEN status = '通过' THEN 1 ELSE 0 END) / COUNT(*) AS pass_rate FROM customer c JOIN loan_application l ON c.id = l.customer_id GROUP BY age_group;
SELECT repayment_amount, repayment_date FROM loan_repayment WHERE loan_application_id = 323803;
SELECT lc.customer_id, lc.credit_score FROM loan_credit lc JOIN bank_orgnization bo ON lc.customer_id = bo.bank_id WHERE bo.bank_name = '杭州上城区支行' AND lc.credit_date = '2023-06-30' ORDER BY lc.credit_score DESC LIMIT 1;
SELECT * FROM loan_repayment WHERE repayment_date < '2020-02-25';
SELECT * FROM transfer WHERE source_customer_id = (SELECT id FROM customer WHERE customer_name = '关飞') OR target_customer_id = (SELECT id FROM customer WHERE customer_name = '关飞');
SELECT c.customer_name, c.id_number, l.status FROM customer c JOIN loan_application l ON c.id = l.customer_id;
SELECT * FROM user_behavior WHERE behavior_type LIKE '%ILL%';
SELECT transfer_amount, description FROM transfer ORDER BY transfer_amount ASC;
SELECT * FROM user_behavior WHERE description IS NOT NULL;
SELECT current_bal FROM debit_card_information WHERE bank_nm = '杭州上城区支行' AND cust_nm = 'James Taylor' AND data_dt = '2024-07-09';
SELECT loan_type_name FROM loan_type WHERE description LIKE '%Loan%';
SELECT c.curr_num, cu.curr_full_name, COUNT(*) FROM credit_card_data c JOIN currency cu ON c.curr_num = cu.curr_code GROUP BY c.curr_num, cu.curr_full_name;
SELECT AVG((wealth_sta_m_avg_bal_a + wealth_sta_m_avg_bal_b) / 2) FROM financial_products;
SELECT lt.loan_type_name, lt.description FROM loan_status ls JOIN loan_type lt ON ls.loan_status_code = lt.loan_type_code WHERE ls.loan_status_name = 'APPROVED';
SELECT c.customer_name, (EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM c.birth_date)) AS age, l.loan_amount FROM loan_application l JOIN customer c ON l.customer_id = c.id WHERE EXTRACT(YEAR FROM l.apply_date) = 2023 ORDER BY age DESC LIMIT 5;
SELECT COUNT(DISTINCT c.id) FROM customer c JOIN loan_credit lc ON c.id = lc.customer_id JOIN bank_orgnization bo ON c.province = '杭州' AND bo.bank_name = '上城区支行' WHERE lc.credit_score > 0.75 AND lc.credit_date = '2023-06-30';
SELECT rs_type_name, COUNT(*) FROM five_level_classification WHERE data_dt = '2024-07-22' GROUP BY rs_type_name;
SELECT rs_type_name, COUNT(*) FROM five_level_classification JOIN user_behavior ON five_level_classification.rs_type = user_behavior.behavior_type GROUP BY rs_type_name;
SELECT * FROM transfer ORDER BY transfer_date;
SELECT card_type, card_type_nm, card_state FROM debit_card_information WHERE cust_no = (SELECT cust_no FROM customer WHERE customer_name = 'James Taylor') AND bank_no = (SELECT bank_id FROM bank_orgnization WHERE bank_name = '杭州上城区支行');
SELECT SUM(wealth_bal) FROM financial_products WHERE currency = 'USD' AND data_dt = '2024-07-02';
SELECT ub.customer_id, COUNT(*) AS behavior_count, lc.credit_score FROM user_behavior ub LEFT JOIN (SELECT customer_id, credit_score FROM loan_credit WHERE (customer_id, credit_date) IN (SELECT customer_id, MAX(credit_date) FROM loan_credit GROUP BY customer_id)) lc ON ub.customer_id = lc.customer_id GROUP BY ub.customer_id, lc.credit_score ORDER BY ub.customer_id;
SELECT c1.customer_name AS source_customer_name, c2.customer_name AS target_customer_name, t.transfer_amount FROM transfer t JOIN customer c1 ON t.source_customer_id = c1.id JOIN customer c2 ON t.target_customer_id = c2.id WHERE t.transfer_date = '2023-06-30' AND t.transfer_amount > 1000;
SELECT * FROM customer WHERE customer_name = '饶丽';
SELECT cust_nm FROM debit_card_information WHERE card_state = '正常' AND data_dt = '2024-07-14';
SELECT l.cust_id, f.rs_type_name, c.curr_full_name FROM loan_detail_info l JOIN five_level_classification f ON l.judgelevel = f.rs_type_id JOIN currency c ON l.currency_type = c.curr_code WHERE l.dw_date = '2024-07-19' AND l.loan_balance > 500000 ORDER BY l.loan_balance DESC;
SELECT COUNT(*) FROM deposit_account_info WHERE data_dt = '2024-07-19' AND bank_nm = '沈阳分行' AND acct_bal > 100000 AND gender_code = '男性';
SELECT * FROM loan_type WHERE loan_type_name = '汽车贷款';
SELECT c.customer_name, l.loan_amount FROM customer c JOIN loan_application l ON c.id = l.customer_id WHERE l.loan_amount > 10000;
SELECT cust_no FROM (SELECT cust_no, (0.4 * COALESCE(SUM(acct_bal), 0) + 0.3 * COALESCE(MAX(credit_score), 0) + 0.3 * COALESCE(SUM(repayment_amount), 0)) AS score FROM deposit_account_info LEFT JOIN loan_credit ON deposit_account_info.cust_no = loan_credit.customer_id LEFT JOIN loan_repayment ON deposit_account_info.cust_no = loan_repayment.loan_application_id GROUP BY cust_no) AS scores ORDER BY score DESC LIMIT 20;
SELECT occupation_code, description FROM occupation WHERE occupation_name = '护士';
SELECT ub.customer_id, ub.behavior_type, ub.behavior_date, ub.description, lc.credit_score FROM user_behavior ub JOIN loan_credit lc ON ub.customer_id = lc.customer_id WHERE DATE_TRUNC('month', ub.behavior_date) = '2021-08-01';
SELECT description FROM loan_type UNION SELECT description FROM loan_status;
SELECT bank_name, SUM(wealth_bal) FROM financial_products JOIN bank_orgnization ON financial_products.org_no = bank_orgnization.bank_id WHERE data_dt = '2024-07-02' AND cust_type = '对公' GROUP BY bank_name;
SELECT customer_id FROM loan_application WHERE YEAR(apply_date) = 2019 AND status = 'REJECTED' AND loan_type_id = (SELECT id FROM loan_type WHERE loan_type_name = '住房贷款');
SELECT cust_no, wealth_bal FROM financial_products WHERE data_dt = '2024-07-19' AND cast_type = '非保本' AND wealth_bal > 100000 ORDER BY wealth_bal DESC;
SELECT customer_name, email FROM customer;
SELECT customer_id, DATE_TRUNC('quarter', apply_date) AS quarter, COUNT(CASE WHEN status = '成功' THEN 1 END)::FLOAT / COUNT(*) AS success_rate FROM loan_application GROUP BY customer_id, quarter;
SELECT cust_name, acct_bal FROM deposit_account_info WHERE data_dt = '2024-07-19' AND cur_type = '美元' ORDER BY acct_bal DESC;
SELECT customer_name, id_number, phone_number, email FROM customer WHERE birth_date > '1980-01-01';
SELECT o.occupation_name FROM loan_application la JOIN customer c ON la.customer_id = c.id JOIN occupation o ON c.occupation_id = o.id ORDER BY la.loan_amount DESC LIMIT 5;
SELECT cust_type, loan_balance FROM loan_detail_info;
SELECT SUM(current_bal) AS total_current_bal, SUM(fixed_bal) AS total_fixed_bal FROM debit_card_information WHERE bank_nm = '杭州上城区支行' AND data_dt = '2023-06-30';
SELECT ub.behavior_type, ls.loan_status_name FROM user_behavior ub JOIN loan_status ls ON ub.customer_id = ls.id WHERE ub.behavior_date = 'specific_date';
SELECT * FROM customer WHERE id_number = 'c839d762-6392-4005-8386-ed4e2c50997a';
SELECT credit_score, description FROM loan_credit WHERE credit_date = '2003-06-22';
SELECT cust_no FROM deposit_account_info WHERE bank_nm = '杭州分行' AND data_dt = '2024-07-21' AND acct_bal > 50000;
SELECT l.cust_id, l.loan_balance, d.acct_bal FROM loan_detail_info l JOIN deposit_account_info d ON l.cust_id = d.cust_no WHERE l.loan_balance > 10000;
SELECT rs_type_name, COUNT(DISTINCT cust_id) AS user_count, SUM(loan_balance) AS total_loan_balance FROM five_level_classification JOIN loan_detail_info ON five_level_classification.rs_type_id = loan_detail_info.judgelevel GROUP BY rs_type_name;
SELECT deposit_name FROM deposit_type WHERE data_dt = '2024-07-22';
SELECT * FROM transfer WHERE transfer_amount > 500;
SELECT c.customer_name, c.id_number, lc.credit_score FROM customer c JOIN loan_credit lc ON c.id = lc.customer_id WHERE c.province = '河北省' AND lc.credit_score > 0.8 ORDER BY lc.credit_score DESC;
SELECT CASE WHEN DATE_PART('year', AGE(NOW(), c.birth_date)) BETWEEN 20 AND 30 THEN '20-30岁' WHEN DATE_PART('year', AGE(NOW(), c.birth_date)) BETWEEN 31 AND 40 THEN '31-40岁' WHEN DATE_PART('year', AGE(NOW(), c.birth_date)) BETWEEN 41 AND 50 THEN '41-50岁' ELSE '51岁以上' END AS age_group, lt.loan_type_name, COUNT(*) AS total_applications, SUM(CASE WHEN la.status = '成功' THEN 1 ELSE 0 END) AS successful_applications, ROUND(SUM(CASE WHEN la.status = '成功' THEN 1 ELSE 0 END) * 1.0 / COUNT(*), 2) AS success_rate FROM loan_application la JOIN customer c ON la.customer_id = c.id JOIN loan_type lt ON la.loan_type_id = lt.id GROUP BY age_group, lt.loan_type_name;
SELECT ls.loan_status_name, o.occupation_name FROM customer c JOIN occupation o ON c.occupation_id = o.id JOIN loan_application la ON c.id = la.customer_id JOIN loan_status ls ON la.status = ls.loan_status_code WHERE o.occupation_code = 'NURSE' AND ls.loan_status_code = 'APPROVED';
SELECT occupation_id, COUNT(customer.id) AS customer_count, AVG(loan_application.loan_amount) AS avg_loan_amount FROM customer JOIN loan_application ON customer.id = loan_application.customer_id GROUP BY occupation_id HAVING COUNT(customer.id) > 100;
SELECT cust_no FROM financial_products WHERE data_dt = '2024-07-14' AND bank_nm = '沈阳余淮支行' AND cast_type = '非保本' AND currency = '新加坡元';
SELECT id_number, phone_number FROM customer;
SELECT cust_nm, open_date FROM debit_card_information WHERE open_date >= '2024-07-05';
SELECT COUNT(DISTINCT fp.cust_no) FROM financial_products fp JOIN user_behavior ub ON fp.cust_no = ub.customer_id WHERE fp.wealth_bal >= (SELECT PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY wealth_bal) FROM financial_products) AND ub.behavior_type = '登录' AND ub.behavior_date >= NOW() - INTERVAL '30 days';
SELECT lc.customer_id, lc.credit_score FROM loan_credit lc JOIN user_behavior ub ON lc.customer_id = ub.customer_id WHERE lc.credit_date = '2023-12-10';
SELECT bank_id, bank_name FROM bank_orgnization;
SELECT lr.id, lr.loan_application_id, lr.repayment_amount, lr.repayment_date, lr.description, la.id, la.customer_id, la.loan_type_id, la.loan_amount, la.loan_term, la.apply_date, la.status FROM loan_repayment lr JOIN loan_application la ON lr.loan_application_id = la.id WHERE lr.repayment_date = '2024-01-20';
SELECT c.curr_code, c.curr_full_name, COUNT(t.id) AS transfer_count FROM currency c LEFT JOIN transfer t ON c.curr_code = t.currency AND t.transfer_date < '2023-06-30' WHERE c.data_dt = '2023-06-30' GROUP BY c.curr_code, c.curr_full_name;
SELECT repayment_amount FROM loan_repayment WHERE loan_application_id = 742969 AND repayment_date = '2021-11-10';
SELECT deposit_type_name, AVG(loan_amount) AS avg_loan_amount, STDDEV(loan_amount) AS stddev_loan_amount FROM loan_application JOIN loan_type ON loan_application.loan_type_id = loan_type.id JOIN deposit_type ON loan_type.loan_type_code = deposit_type.deposit_type_id GROUP BY deposit_type_name;
SELECT c.customer_name, o.occupation_name, lr.repayment_date FROM customer c JOIN loan_application la ON c.id = la.customer_id JOIN loan_repayment lr ON la.id = lr.loan_application_id JOIN occupation o ON c.occupation_id = o.id;
SELECT loan_type_id, AVG(loan_amount) AS avg_loan_amount, AVG(acct_bal) AS avg_deposit_balance FROM loan_application JOIN deposit_account_info ON loan_application.customer_id = deposit_account_info.cust_no GROUP BY loan_type_id;
SELECT COUNT(DISTINCT la.customer_id) FROM loan_application la JOIN user_behavior ub ON la.customer_id = ub.customer_id WHERE la.apply_date = '2019-01-10' AND la.status = 'REJECTED' AND ub.behavior_date = '2017-10-24' AND ub.behavior_type = 'LOGIN';
SELECT c.customer_name, la.loan_amount FROM loan_application la JOIN loan_credit lc ON la.customer_id = lc.customer_id JOIN customer c ON la.customer_id = c.id WHERE YEAR(la.apply_date) = 2019 AND lc.credit_score > 0.8 ORDER BY la.loan_amount DESC;
SELECT * FROM loan_detail_info WHERE loan_balance > 500000 ORDER BY loan_balance DESC;
SELECT customer_id, credit_score FROM loan_credit WHERE credit_date = '2003-06-22' AND credit_score > 0.75;
SELECT customer_name, birth_date FROM customer WHERE birth_date > '1990-01-01';
SELECT customer_id FROM loan_credit WHERE credit_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) GROUP BY customer_id ORDER BY MAX(credit_score) - MIN(credit_score) DESC LIMIT 5;
SELECT behavior_type, COUNT(*) FROM user_behavior GROUP BY behavior_type;
SELECT deposit_type.deposit_type_name, COUNT(DISTINCT CASE WHEN deposit_account_info.data_dt >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) THEN deposit_account_info.cust_no END) / COUNT(DISTINCT deposit_account_info.cust_no) AS retention_rate FROM deposit_account_info JOIN deposit_type ON deposit_account_info.acct_type_code = deposit_type.deposit_type_id GROUP BY deposit_type.deposit_type_name;
SELECT SUM(transfer_amount) FROM transfer WHERE transfer_date = '2024-07-19' AND source_customer_id IN (SELECT customer_id FROM customer WHERE province = '沈阳');
SELECT s.manager_name FROM stores s JOIN (SELECT store_id, SUM(profit) AS total_profit FROM salesstatistics WHERE date = '2023-05-06' GROUP BY store_id ORDER BY total_profit DESC LIMIT 1) t ON s.store_id = t.store_id;
SELECT profit, sales_quantity FROM salesstatistics;
SELECT order_id FROM salesorders WHERE order_date = '2023-05-08';
SELECT employee_id FROM salesorders WHERE store_id = (SELECT store_id FROM stores WHERE store_name = '数码广场店') AND order_date = '2023-05-05' AND total_amount > 7000;
SELECT * FROM salesstatistics ORDER BY profit DESC LIMIT 1;
SELECT stores.store_name, employees.name, salesstatistics.sales_amount, products.product_name FROM salesstatistics JOIN stores ON salesstatistics.store_id = stores.store_id JOIN employees ON salesstatistics.employee_id = employees.employee_id JOIN products ON salesstatistics.product_id = products.product_id WHERE salesstatistics.date BETWEEN '2023-05-01' AND '2023-05-31' AND salesstatistics.sales_amount > 10000 AND products.supplier_name = '苹果官方旗舰店';
SELECT p.product_name, p.supplier_name FROM salesstatistics s JOIN products p ON s.product_id = p.product_id JOIN stores st ON s.store_id = st.store_id WHERE st.store_name = '电子城旗舰店';
SELECT s.store_name, e.position FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-09' AND p.product_name = 'iPad Air';
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-05' GROUP BY so.store_id, s.manager_name HAVING SUM(so.total_amount) > 10000;
SELECT e.name, s.total_amount FROM employees e JOIN salesorders s ON e.employee_id = s.employee_id WHERE s.order_date = '2023-05-07' AND s.total_amount > 10000;
SELECT store_id FROM salesstatistics WHERE product_id = (SELECT product_id FROM products WHERE product_name = '索尼WH-1000XM4') AND date >= '2023-05-01' AND date <= '2023-05-31' GROUP BY store_id HAVING SUM(profit) > 5000;
SELECT DISTINCT s.employee_id FROM salesorders s JOIN orderdetails o ON s.order_id = o.order_id JOIN products p ON o.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND s.order_date BETWEEN '2023-05-01' AND '2023-05-31' AND s.total_amount > 5000;
SELECT p.product_name, s.profit FROM salesstatistics s JOIN products p ON s.product_id = p.product_id WHERE s.sales_amount = (SELECT MAX(sales_amount) FROM salesstatistics);
SELECT od.order_id, p.product_name, so.total_amount FROM orderdetails od JOIN products p ON od.product_id = p.product_id JOIN salesorders so ON od.order_id = so.order_id;
SELECT e.name, s.store_name FROM employees e JOIN stores s ON e.store_id = s.store_id;
SELECT s.manager_name, SUM(so.total_amount) FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-08' GROUP BY s.manager_name;
SELECT s.order_id, e.name FROM salesorders s JOIN employees e ON s.employee_id = e.employee_id WHERE s.total_amount > 7000;
SELECT s.store_name, e.name, ss.sales_amount, p.product_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' AND ss.sales_amount > 10000 AND p.supplier_name = '苹果官方旗舰店';
SELECT DISTINCT s.store_name FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE p.product_name = 'iPhone 13' AND ss.date = '2023-05-06' AND ss.profit > 4000;
SELECT * FROM salesorders WHERE order_id = 'b8b62bfe-a35d-4ff5-9bc9-654b5f67fed2';
SELECT employee_id, SUM(total_amount) FROM salesorders GROUP BY employee_id;
SELECT product_name, sale_price, purchase_price FROM products;
SELECT e.employee_id, s.manager_name FROM salesorders so JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON e.store_id = s.store_id WHERE so.order_date >= '2023-05-01' AND so.order_date < '2023-06-01' GROUP BY e.employee_id, s.manager_name HAVING SUM(so.total_amount) > 10000;
SELECT e.employee_id, s.store_id FROM employees e JOIN stores s ON e.name = s.manager_name;
SELECT s.store_name, ss.profit FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-07' AND p.product_name = 'Apple Watch Series 7';
SELECT s.store_id FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-05' AND p.sale_price > 5000 GROUP BY s.store_id HAVING SUM(so.total_amount) > 10000;
SELECT o.order_id, p.product_name, o.quantity FROM orderdetails o JOIN products p ON o.product_id = p.product_id;
SELECT * FROM salesorders WHERE store_id = '0887d06a-27a8-46b4-98d6-514702e698da';
SELECT s.employee_id FROM salesstatistics s JOIN orderdetails o ON s.employee_id = o.employee_id WHERE strftime('%Y-%m', s.date) = '2023-05' GROUP BY s.employee_id HAVING SUM(s.sales_quantity) > SUM(o.quantity);
SELECT s.store_id, SUM(so.total_amount) FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'iPad Air' AND so.order_date = '2023-05-01' GROUP BY s.store_id;
SELECT od.product_id, od.quantity, so.order_date FROM orderdetails od JOIN salesorders so ON od.order_id = so.order_id;
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE strftime('%Y-%m', so.order_date) = '2023-05' GROUP BY so.store_id ORDER BY SUM(so.total_amount) DESC LIMIT 1;
SELECT employee_id FROM salesstatistics JOIN stores ON salesstatistics.store_id = stores.store_id JOIN products ON salesstatistics.product_id = products.product_id WHERE stores.store_name = '数码广场店' AND products.product_name = 'iPhone 13' AND salesstatistics.date = '2023-05-03' AND salesstatistics.sales_quantity > 1;
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-07' GROUP BY so.store_id ORDER BY SUM(so.total_amount) DESC LIMIT 1;
SELECT DISTINCT s.store_id FROM salesorders s JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '索尼WH-1000XM4' AND s.order_date = '2023-05-01' AND s.total_amount > 8000;
SELECT purchase_price, sale_price FROM products WHERE product_id = '某一商品的ID';
SELECT product_id, unit_price, quantity FROM orderdetails;
SELECT e.name, s.store_name FROM salesstatistics ss JOIN employees e ON ss.employee_id = e.employee_id JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-06' AND p.product_name = 'Apple Watch Series 7';
SELECT store_id, SUM(sales_amount) AS total_sales FROM salesstatistics GROUP BY store_id ORDER BY SUM(sales_quantity) DESC LIMIT 1;
SELECT DISTINCT e.employee_id, p.category_name FROM salesorders s JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN employees e ON s.employee_id = e.employee_id WHERE s.order_date >= '2023-05-01' AND s.order_date <= '2023-05-31' AND s.total_amount > 10000;
SELECT e.employee_id, e.store_id, SUM(s.total_amount) AS total_order_amount FROM employees e JOIN salesorders s ON e.employee_id = s.employee_id GROUP BY e.employee_id, e.store_id;
SELECT s.store_id, SUM(so.total_amount) AS total_sales_amount, s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date >= '2023-05-01' AND so.order_date <= '2023-05-31' GROUP BY s.store_id, s.manager_name;
SELECT product_id, order_detail_id FROM salesstatistics JOIN orderdetails ON salesstatistics.product_id = orderdetails.product_id WHERE sales_quantity > 5 AND date >= '2023-05-01' AND date < '2023-06-01';
SELECT p.product_id, SUM(od.quantity) AS sales_quantity, p.sale_price FROM products p JOIN orderdetails od ON p.product_id = od.product_id GROUP BY p.product_id, p.sale_price;
SELECT s.manager_name, ss.profit FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE p.product_name = '佳能EOS R6' AND ss.date = '2023-05-01';
SELECT store_name, address, phone FROM stores;
SELECT so.order_id, p.product_name FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.total_amount < 5000;
SELECT store_id, SUM(profit) AS total_profit FROM salesstatistics WHERE date >= '2023-05-01' AND date < '2023-06-01' GROUP BY store_id, employee_id ORDER BY SUM(sales_quantity) DESC LIMIT 1;
SELECT store_id, SUM(profit) FROM salesstatistics WHERE product_id = (SELECT product_id FROM products WHERE product_name = '小米电视4A') AND date >= '2023-05-01' AND date <= '2023-05-31' GROUP BY store_id;
SELECT s.employee_id, SUM(s.profit) FROM salesstatistics s JOIN stores st ON s.store_id = st.store_id JOIN products p ON s.product_id = p.product_id WHERE st.store_name = '智慧街店' AND p.product_name = '小米电视4A' AND s.date = '2023-05-06' GROUP BY s.employee_id;
SELECT store_name, phone FROM stores;
SELECT s.store_name, s.manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-08' AND ss.profit > 1000;
SELECT category_name, SUM(sales_quantity) FROM products JOIN salesstatistics ON products.product_id = salesstatistics.product_id GROUP BY category_name;
SELECT s.store_name, e.name FROM stores s JOIN employees e ON s.store_id = e.store_id;
SELECT order_id FROM salesorders WHERE total_amount > (SELECT AVG(total_amount) FROM salesorders);
SELECT * FROM salesorders WHERE order_date BETWEEN '开始日期' AND '结束日期';
SELECT e.employee_id, e.name, s.order_date, s.total_amount FROM employees e JOIN salesorders s ON e.employee_id = s.employee_id;
SELECT employee_id, SUM(total_amount) FROM salesorders GROUP BY employee_id;
SELECT employee_id, SUM(sales_quantity) AS total_sales_quantity, SUM(profit) AS total_profit FROM salesstatistics GROUP BY employee_id;
SELECT DISTINCT s.store_id FROM salesorders s JOIN orderdetails o ON s.order_id = o.order_id JOIN products p ON o.product_id = p.product_id WHERE p.product_name = '佳能EOS R6' AND s.order_date >= '2023-05-01' AND s.order_date <= '2023-05-31' AND s.total_amount > 10000;
SELECT manager_name FROM stores WHERE store_id = (SELECT store_id FROM salesorders WHERE order_date = '2023-05-05' GROUP BY store_id ORDER BY SUM(total_amount) DESC LIMIT 1);
SELECT s.store_name, SUM(ss.sales_quantity) AS total_sales_quantity, SUM(ss.sales_amount) AS total_sales_amount FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id GROUP BY s.store_name;
SELECT manager_name FROM stores WHERE store_id = (SELECT store_id FROM salesstatistics WHERE date >= '2023-05-01' AND date <= '2023-05-31' GROUP BY store_id ORDER BY SUM(sales_quantity) DESC LIMIT 1);
SELECT order_id, total_amount FROM salesorders WHERE employee_id = '特定员工ID';
SELECT order_detail_id, order_id, product_id, quantity, unit_price FROM orderdetails WHERE product_id = '某商品';
SELECT store_id, date, SUM(sales_amount) AS total_sales_amount FROM salesstatistics GROUP BY store_id, date;
SELECT p.product_name FROM products p JOIN stores s ON p.store_id = s.store_id WHERE s.store_name = '未来城店' AND p.purchase_price > 4000;
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-09' GROUP BY so.store_id, s.manager_name HAVING SUM(so.total_amount) > 10000;
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-02' GROUP BY so.store_id ORDER BY SUM(so.total_amount) DESC LIMIT 1;
SELECT manager_name FROM stores WHERE store_id IN (SELECT store_id FROM salesstatistics WHERE date = '2023-05-09' AND sales_amount > 1000);
SELECT DISTINCT s.employee_id, p.category_name FROM salesorders s JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE s.order_date >= '2023-05-01' AND s.order_date < '2023-06-01' AND s.total_amount > 10000;
SELECT store_name, SUM(profit) FROM salesstatistics JOIN stores ON salesstatistics.store_id = stores.store_id GROUP BY store_name;
SELECT s.store_name, e.name, ss.sales_amount, p.product_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' AND ss.sales_amount > 10000 AND p.supplier_name = '索尼官方旗舰店';
SELECT s.order_id, o.product_id, o.quantity, o.unit_price FROM salesorders s JOIN orderdetails o ON s.order_id = o.order_id WHERE s.total_amount > 5000;
SELECT product_id, sales_amount FROM salesstatistics WHERE date = '2023-05-02';
SELECT s.sales_quantity, st.store_name FROM salesstatistics s JOIN stores st ON s.store_id = st.store_id WHERE YEAR(s.date) = 2023 AND MONTH(s.date) = 5;
SELECT product_id, sale_price, purchase_price FROM products;
SELECT s.store_name, SUM(ss.sales_quantity) AS sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE p.category_name = '智能手表' AND p.supplier_name = '索尼官方旗舰店' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' GROUP BY s.store_name HAVING SUM(ss.sales_quantity) > 10;
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date >= '2023-05-01' AND so.order_date <= '2023-05-31' GROUP BY so.store_id, s.manager_name HAVING AVG(so.total_amount) > 10000;
SELECT store_id, profit FROM salesstatistics WHERE date = '2023-05-02' AND product_id = (SELECT product_id FROM products WHERE product_name = 'iPad Air');
SELECT store_id, SUM(profit) FROM salesstatistics WHERE product_id = (SELECT product_id FROM products WHERE product_name = 'iPhone 13') AND date >= '2023-05-01' AND date <= '2023-05-31' GROUP BY store_id;
SELECT store_id, SUM(sales_amount) AS total_sales_amount FROM salesstatistics WHERE date >= '2023-05-01' AND date < '2023-06-01' GROUP BY store_id ORDER BY SUM(sales_quantity) DESC LIMIT 1;
SELECT s.store_id, SUM(s.total_amount) FROM salesorders s JOIN orderdetails o ON s.order_id = o.order_id JOIN products p ON o.product_id = p.product_id WHERE p.product_name = 'Apple Watch Series 7' AND s.order_date = '2023-05-09' GROUP BY s.store_id;
SELECT quantity, unit_price FROM orderdetails;
SELECT s.store_name, e.position FROM stores s JOIN employees e ON s.store_id = e.store_id JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND so.order_date >= '2023-05-01' AND so.order_date <= '2023-05-31';
SELECT * FROM salesstatistics WHERE sales_quantity > 1;
SELECT s.store_id, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE p.product_name = 'Nintendo Switch' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' GROUP BY s.store_id;
SELECT total_amount, order_date FROM salesorders;
SELECT store_id, SUM(total_amount) AS total_order_amount, SUM(sales_quantity) AS total_sales_quantity FROM salesorders JOIN salesstatistics USING (store_id) GROUP BY store_id;
SELECT * FROM orderdetails WHERE quantity = 2;
SELECT s.store_name, e.position FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN employees e ON ss.employee_id = e.employee_id JOIN stores s ON ss.store_id = s.store_id WHERE p.product_name = '戴尔灵越15' AND ss.date = '2023-05-01';
SELECT position, store_id FROM employees;
SELECT s.store_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE p.product_name = '佳能EOS R6' AND ss.date = '2023-05-03' GROUP BY s.store_name;
SELECT s.store_name, SUM(ss.profit) AS total_profit FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE p.product_name = 'iPhone 13' AND ss.date = '2023-05-05' GROUP BY s.store_name;
SELECT DISTINCT s.store_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = '华为Mate 40 Pro' AND ss.sales_quantity > 1 AND ss.date = '2023-05-06';
SELECT o.order_id, p.product_name, o.quantity FROM orderdetails o JOIN products p ON o.product_id = p.product_id;
SELECT e.name, e.position, s.phone FROM employees e JOIN stores s ON e.store_id = s.store_id;
SELECT s.store_name, e.name, ss.sales_quantity FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-05' AND p.product_name = '戴尔灵越15' AND ss.sales_quantity > 1;
SELECT so.order_id, p.product_name FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.total_amount > 5000;
SELECT employee_id, total_amount FROM salesorders GROUP BY employee_id;
SELECT date FROM salesstatistics WHERE profit > 3000;
SELECT DISTINCT s.store_name FROM stores s JOIN salesorders so ON s.store_id = so.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'Apple Watch Series 7' AND so.order_date = '2023-05-01' AND so.total_amount > 7000;
SELECT remaining_quantity, category_name FROM products;
SELECT DISTINCT e.employee_id FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN employees e ON so.employee_id = e.employee_id WHERE so.order_date = '2023-05-07' AND p.category_name = '相机' AND so.total_amount > 15000;
SELECT store_id, SUM(profit) FROM salesstatistics JOIN products ON salesstatistics.product_id = products.product_id WHERE products.product_name = 'iPhone 13' AND salesstatistics.date = '2023-05-03' GROUP BY store_id;
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-08' GROUP BY so.store_id, s.manager_name ORDER BY SUM(so.total_amount) DESC LIMIT 1;
SELECT e.employee_id, ss.sales_quantity, ss.sales_amount FROM employees e JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN stores s ON ss.store_id = s.store_id JOIN products p ON ss.product_id = p.product_id WHERE s.store_name = '数字大道店' AND p.product_name = 'Nintendo Switch' AND ss.date = '2023-05-03';
SELECT DISTINCT s.store_id FROM salesstatistics s JOIN products p ON s.product_id = p.product_id WHERE s.date = '2023-05-05' AND p.product_name = '戴森V11' AND s.profit > 500;
SELECT s.store_name, s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-09' AND so.total_amount > 2000;
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-01' GROUP BY s.manager_name HAVING SUM(so.total_amount) > 10000;
SELECT s.manager_name FROM stores s JOIN salesstatistics ss ON s.store_id = ss.store_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'iPhone 13' AND ss.date = '2023-05-09';
SELECT s.sales_amount, p.remaining_quantity FROM salesstatistics s JOIN products p ON s.product_id = p.product_id WHERE p.product_id = '某个商品的ID';
SELECT store_name, address, phone FROM stores;
SELECT s.store_name, e.name, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id WHERE so.order_date = '2023-05-02' AND so.total_amount > 2000;
SELECT store_id, SUM(sales_quantity) AS total_sales_quantity, SUM(profit) AS total_profit FROM salesstatistics GROUP BY store_id;
SELECT s.store_name, s.manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-07' AND ss.profit > 1000;
SELECT s.manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-08' GROUP BY ss.store_id ORDER BY SUM(ss.sales_quantity) DESC LIMIT 1;
SELECT store_id FROM salesstatistics WHERE date = '2023-05-09' GROUP BY store_id ORDER BY SUM(profit) DESC LIMIT 1;
SELECT DISTINCT s.store_name FROM stores s JOIN salesorders so ON s.store_id = so.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '佳能EOS R6相机' AND so.order_date >= '2023-05-01' AND so.order_date <= '2023-05-31' AND so.total_amount > 5000;
SELECT DISTINCT s.store_id, e.position FROM products p JOIN orderdetails od ON p.product_id = od.product_id JOIN salesorders so ON od.order_id = so.order_id JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id WHERE p.product_name = 'iPad Air' AND so.order_date >= '2023-05-01' AND so.order_date <= '2023-05-31';
SELECT category_name, sale_price FROM products;
SELECT s.store_id, COUNT(DISTINCT e.employee_id) FROM salesstatistics s JOIN employees e ON s.store_id = e.store_id WHERE strftime('%Y-%m', s.date) = '2023-05' AND e.position = '销售经理' GROUP BY s.store_id HAVING SUM(s.sales_amount) > 10000;
SELECT p.product_id, p.remaining_quantity, SUM(s.sales_quantity) AS sales_quantity FROM products p LEFT JOIN salesstatistics s ON p.product_id = s.product_id GROUP BY p.product_id, p.remaining_quantity;
SELECT order_date, total_amount FROM salesorders;
SELECT store_name FROM stores WHERE store_id IN (SELECT store_id FROM salesstatistics WHERE product_id = (SELECT product_id FROM products WHERE product_name = '华为Mate 40 Pro') AND date = '2023-05-06' AND sales_quantity > 1);
SELECT s.store_name, e.name, e.position FROM employees e JOIN stores s ON e.store_id = s.store_id;
SELECT e.employee_id, SUM(s.total_amount) FROM salesorders s JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores st ON s.store_id = st.store_id JOIN employees e ON s.employee_id = e.employee_id WHERE s.order_date = '2023-05-01' AND p.product_name = '华为Mate 40 Pro' AND st.store_name = '创客空间店' GROUP BY e.employee_id;
SELECT DISTINCT s.store_id, e.position FROM salesorders s JOIN employees e ON s.employee_id = e.employee_id JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '戴森V11' AND s.order_date >= '2023-05-01' AND s.order_date <= '2023-05-31';
SELECT od.order_detail_id, od.order_id, od.product_id, od.quantity, od.unit_price, p.product_name, p.category_name, p.purchase_price, p.sale_price, p.remaining_quantity, p.supplier_name, p.description FROM orderdetails od JOIN products p ON od.product_id = p.product_id;
SELECT e.employee_id, e.name FROM employees e JOIN salesstatistics s ON e.employee_id = s.employee_id JOIN products p ON s.product_id = p.product_id WHERE s.date = '2023-05-06' AND s.sales_quantity > 1 AND p.supplier_name = '戴尔官方旗舰店';
SELECT product_name, sale_price FROM products;
SELECT manager_name, phone FROM stores;
SELECT s.total_amount, st.store_name FROM salesorders s JOIN employees e ON s.employee_id = e.employee_id JOIN stores st ON s.store_id = st.store_id WHERE s.order_date = '2023-05-07' AND e.name = '范莹';
SELECT s.store_name FROM stores s JOIN salesstatistics ss ON s.store_id = ss.store_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = 'Apple Watch Series 7' AND ss.date >= '2023-05-01' AND ss.date <= '2023-05-31' GROUP BY s.store_name HAVING SUM(ss.sales_amount) > 10000;
SELECT store_id, SUM(total_amount) FROM salesorders WHERE order_date >= '2023-05-01' AND order_date < '2023-06-01' GROUP BY store_id;
SELECT store_name, manager_name FROM stores;
SELECT sale_price, remaining_quantity FROM products;
SELECT s.store_id, SUM(so.total_amount) FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = 'iPhone 13' AND so.order_date = '2023-05-01' GROUP BY s.store_id;
SELECT DISTINCT s.store_id FROM salesorders s JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '索尼WH-1000XM4' AND s.order_date = '2023-05-08' AND s.total_amount > 15000;
SELECT s.manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-09' GROUP BY ss.store_id ORDER BY SUM(ss.sales_quantity) DESC LIMIT 1;
SELECT SUM(profit) FROM salesstatistics;
SELECT s.order_id, s.order_date, st.store_name FROM salesorders s JOIN stores st ON s.store_id = st.store_id WHERE s.employee_id = '特定员工ID';
SELECT s.store_name, SUM(ss.sales_quantity) AS total_sales FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN salesstatistics ss ON so.order_id = ss.order_id JOIN stores s ON so.store_id = s.store_id WHERE e.name = '黄萍' AND DATE_FORMAT(so.order_date, '%Y-%m') = '2023-05' GROUP BY s.store_name ORDER BY total_sales DESC LIMIT 1;
SELECT s.store_id, s.profit FROM salesstatistics s JOIN products p ON s.product_id = p.product_id WHERE p.product_name = 'Nintendo Switch' AND s.date = '2023-05-08';
SELECT s.store_id, SUM(so.total_amount) AS total_sales_amount FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '索尼WH-1000XM4耳机' AND DATE(so.order_date) = '2023-05-05' GROUP BY s.store_id;
SELECT DISTINCT e.name FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-05' AND s.store_name = '智能生活馆' AND p.supplier_name = '小米官方旗舰店';
SELECT s.manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-07' GROUP BY ss.store_id, s.manager_name ORDER BY SUM(ss.profit) DESC LIMIT 1;
SELECT store_id, employee_id, profit FROM salesstatistics WHERE product_id = (SELECT product_id FROM products WHERE product_name = '索尼WH-1000XM4耳机') AND date = '2023-05-09';
SELECT product_id, sales_quantity, sales_amount FROM salesstatistics WHERE product_id = '某个商品';
SELECT s.total_amount, st.store_name FROM salesorders s JOIN stores st ON s.store_id = st.store_id WHERE s.order_date = '2023-05-03';
SELECT * FROM orderdetails WHERE quantity > 1;
SELECT s.store_name, so.total_amount FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-05' AND p.product_name = 'iPhone 13';
SELECT s.store_name, so.* FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-05';
SELECT p.product_name, o.order_id FROM orderdetails o JOIN products p ON o.product_id = p.product_id WHERE o.quantity > 1;
SELECT order_id FROM salesorders WHERE order_date BETWEEN '2023-05-01' AND '2023-05-31';
SELECT employee_id, SUM(sales_quantity) FROM salesstatistics GROUP BY employee_id;
SELECT category_name, remaining_quantity FROM products;
SELECT s.store_name, SUM(ss.sales_quantity) AS total_sales FROM employees e JOIN salesstatistics ss ON e.employee_id = ss.employee_id JOIN stores s ON e.store_id = s.store_id GROUP BY e.employee_id, s.store_name;
SELECT order_id, product_id FROM orderdetails;
SELECT * FROM salesstatistics WHERE date = '2023-10-01';
SELECT e.employee_id, SUM(od.quantity) AS sales_quantity, SUM(od.quantity * od.unit_price) AS total_amount FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id WHERE s.store_name = '科技园店' AND p.product_name = 'iPhone 13' AND so.order_date = '2023-05-01' GROUP BY e.employee_id;
SELECT e.name FROM employees e JOIN salesorders so ON e.employee_id = so.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE so.order_date = '2023-05-09' AND p.product_name = 'Apple Watch Series 7' AND p.supplier_name = '任天堂官方旗舰店';
SELECT s.store_name, SUM(so.total_amount) FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-06' GROUP BY s.store_name;
SELECT * FROM salesorders WHERE order_date = '特定日期';
SELECT e.name, SUM(s.total_amount) FROM employees e JOIN salesorders s ON e.employee_id = s.employee_id JOIN stores st ON s.store_id = st.store_id JOIN orderdetails od ON s.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE st.store_name = '智慧街店' AND p.product_name = '佳能EOS R6相机' AND s.order_date = '2023-05-07' GROUP BY e.name;
SELECT store_id, SUM(total_amount) AS total_sales_amount, COUNT(order_id) AS total_sales_quantity FROM salesorders GROUP BY store_id;
SELECT s.store_name, SUM(so.total_amount) FROM stores s JOIN salesorders so ON s.store_id = so.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '佳能EOS R6' AND so.order_date = '2023-05-05' GROUP BY s.store_name;
SELECT * FROM products WHERE sale_price > 15000;
SELECT store_id FROM salesstatistics JOIN products ON salesstatistics.product_id = products.product_id WHERE products.product_name = '索尼WH-1000XM4' AND salesstatistics.date = '2023-05-08' AND salesstatistics.sales_quantity > 1;
SELECT s.store_name, e.name, p.product_name, ss.sales_amount FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id JOIN employees e ON ss.employee_id = e.employee_id JOIN products p ON ss.product_id = p.product_id WHERE ss.date = '2023-05-01' AND ss.sales_amount > 1000 AND p.supplier_name = '戴森官方旗舰店';
SELECT sales_quantity FROM salesstatistics WHERE product_id = '特定商品ID';
SELECT s.store_name, SUM(so.total_amount) AS total_sales FROM salesorders so JOIN stores s ON so.store_id = s.store_id GROUP BY s.store_name;
SELECT s.order_id, o.quantity FROM salesorders s JOIN orderdetails o ON s.order_id = o.order_id WHERE s.order_date = '特定日期';
SELECT s.order_id, s.order_date, e.name FROM salesorders s JOIN employees e ON s.employee_id = e.employee_id;
SELECT product_name, supplier_name FROM products;
SELECT product_name, sale_price, supplier_name FROM products;
SELECT orderdetails.*, products.product_name, products.sale_price FROM orderdetails JOIN products ON orderdetails.product_id = products.product_id;
SELECT store_name, phone FROM stores WHERE store_id IN (SELECT store_id FROM salesstatistics WHERE date >= '2023-05-01' AND date <= '2023-05-31' GROUP BY store_id HAVING SUM(sales_amount) > 3000);
SELECT store_name, manager_name FROM stores;
SELECT e.name, s.phone FROM employees e JOIN stores s ON e.store_id = s.store_id;
SELECT s.employee_id, s.sales_quantity, s.profit FROM salesstatistics s JOIN stores st ON s.store_id = st.store_id JOIN products p ON s.product_id = p.product_id WHERE st.store_name = '创新路专卖店' AND p.product_name = 'iPad Air' AND s.date = '2023-05-09';
SELECT employee_id FROM salesorders WHERE order_date = '2023-05-07' AND store_id = '未来城店' AND total_amount > 15000;
SELECT sale_price - purchase_price FROM products;
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date >= '2023-05-01' AND so.order_date <= '2023-05-31' GROUP BY s.store_id, s.manager_name HAVING SUM(so.total_amount) > 10000;
SELECT store_id, SUM(profit) AS total_profit, SUM(sales_quantity) AS total_sales_quantity FROM salesstatistics GROUP BY store_id;
SELECT * FROM salesorders WHERE store_id = '64921abb-1d54-4e03-a15e-ea42f058f31c';
SELECT DISTINCT s.store_name FROM stores s JOIN salesorders so ON s.store_id = so.store_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '小米电视4A' AND so.order_date = '2023-05-06' AND so.total_amount > 10000;
SELECT DISTINCT s.store_name FROM salesstatistics ss JOIN products p ON ss.product_id = p.product_id JOIN stores s ON ss.store_id = s.store_id WHERE p.product_name = 'Nintendo Switch' AND ss.profit > 1000 AND ss.date >= '2023-05-01' AND ss.date < '2023-06-01';
SELECT s.store_id, SUM(ss.sales_quantity) AS total_quantity, SUM(ss.sales_amount) AS total_amount FROM salesstatistics ss JOIN salesorders s ON ss.order_id = s.order_id JOIN products p ON ss.product_id = p.product_id WHERE p.product_name = '索尼WH-1000XM4' AND s.order_date = '2023-05-09' GROUP BY s.store_id;
SELECT * FROM salesorders WHERE store_id = '特定门店ID';
SELECT s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-03' GROUP BY so.store_id, s.manager_name ORDER BY SUM(so.total_amount) DESC LIMIT 1;
SELECT manager_name FROM stores WHERE store_id = (SELECT store_id FROM salesstatistics WHERE date = '2023-05-03' GROUP BY store_id ORDER BY SUM(sales_quantity) DESC LIMIT 1);
SELECT s.store_name, so.total_amount FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN stores s ON so.store_id = s.store_id WHERE p.product_name = 'iPad Air' AND so.order_date = '2023-05-01';
SELECT store_id, SUM(total_amount) FROM salesorders GROUP BY store_id;
SELECT e.position, COUNT(s.order_id) FROM employees e JOIN salesorders s ON e.employee_id = s.employee_id GROUP BY e.position, e.employee_id;
SELECT * FROM salesstatistics WHERE store_id = '特定门店ID';
SELECT s.store_name, s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date >= '2023-05-01' AND so.order_date <= '2023-05-31' GROUP BY s.store_name, s.manager_name HAVING SUM(so.total_amount) > 10000;
SELECT DISTINCT s.store_id FROM salesstatistics s JOIN products p ON s.product_id = p.product_id WHERE s.date = '2023-05-02' AND s.sales_amount > 10000 AND p.supplier_name = '华为官方旗舰店';
SELECT s.order_id, s.store_id, s.employee_id, s.order_date, s.total_amount FROM salesorders s JOIN (SELECT order_id FROM salesstatistics WHERE date BETWEEN '指定开始日期' AND '指定结束日期' ORDER BY sales_quantity DESC LIMIT 1) ss ON s.order_id = ss.order_id;
SELECT * FROM salesorders WHERE employee_id = '特定员工ID';
SELECT s.store_id, s.manager_name FROM salesorders so JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-04' GROUP BY s.store_id, s.manager_name ORDER BY SUM(so.total_amount) DESC LIMIT 1;
SELECT DISTINCT s.store_name, e.position FROM salesorders so JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id JOIN employees e ON so.employee_id = e.employee_id JOIN stores s ON so.store_id = s.store_id WHERE so.order_date = '2023-05-01' AND p.product_name = '华为Mate 40 Pro';
SELECT s.manager_name FROM salesstatistics ss JOIN stores s ON ss.store_id = s.store_id WHERE ss.date = '2023-05-06' AND ss.sales_amount > 10000;
SELECT s.store_name, e.name, so.total_amount FROM salesorders so JOIN stores s ON so.store_id = s.store_id JOIN employees e ON so.employee_id = e.employee_id JOIN orderdetails od ON so.order_id = od.order_id JOIN products p ON od.product_id = p.product_id WHERE p.product_name = '戴尔灵越15笔记本电脑' AND so.order_date >= '2023-05-01' AND so.order_date <= '2023-05-31' AND so.total_amount > 5000;
SELECT product_id, remaining_quantity, sale_price FROM products;
SELECT store_id, COUNT(employee_id) FROM employees GROUP BY store_id;
SELECT e.employee_id FROM employees e JOIN salesstatistics s ON e.employee_id = s.employee_id JOIN products p ON s.product_id = p.product_id JOIN stores st ON s.store_id = st.store_id WHERE s.date = '2023-05-05' AND st.store_name = '科技中心店' AND p.product_name = '戴森V11' AND s.sales_quantity > 1;
SELECT order_id, total_amount FROM salesorders WHERE store_id = (SELECT store_id FROM stores WHERE store_name = '数码广场店');
SELECT re.* FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id WHERE ra.risk_level = '高' AND ra.impact_score > 8;
SELECT * FROM risk_events WHERE event_type = '合规风险';
SELECT re.event_id, al.audit_result FROM risk_events re JOIN audit_logs al ON re.event_id = al.related_id JOIN alerts a ON re.event_id = a.event_id WHERE a.alert_type = '欺诈嫌疑';
SELECT report_type, AVG(severity) FROM risk_reports JOIN risk_events ON risk_reports.event_id = risk_events.event_id WHERE approval_status = '已批准' GROUP BY report_type;
SELECT risk_level, COUNT(customer_id), AVG(credit_score) FROM customers GROUP BY risk_level;
SELECT ri.*, rml.* FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE rml.monitoring_date LIKE '2023-10%';
SELECT report_id, author, event_id FROM risk_reports WHERE approval_status = '已批准';
SELECT c.risk_level, t.transaction_type, CASE WHEN t.amount BETWEEN 0 AND 1000 THEN '0-1000' WHEN t.amount BETWEEN 1001 AND 5000 THEN '1001-5000' WHEN t.amount BETWEEN 5001 AND 10000 THEN '5001-10000' ELSE '10000+' END AS amount_range, COUNT(*) AS transaction_count, AVG(t.risk_score) AS avg_risk_score FROM transactions t JOIN customers c ON t.customer_id = c.customer_id GROUP BY c.risk_level, t.transaction_type, amount_range;
SELECT audit_result FROM audit_logs WHERE event_id = '特定风险事件ID';
SELECT rr.report_id, rr.report_type, rr.report_date, rr.report_content, re.event_id, re.event_type, re.event_description, re.occurrence_time, re.severity, re.status, ra.assessment_id, ra.assessor, ra.assessment_date, ra.risk_level, ra.impact_score, ra.probability_score, ra.mitigation_plan FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE rr.author = '周婷';
SELECT author, approval_status FROM risk_reports WHERE report_date > '2023-01-01';
SELECT re.event_description, ra.risk_level, ra.mitigation_plan FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE re.event_description LIKE '%系统%';
SELECT indicator_id, MAX(CASE WHEN monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = rml.indicator_id) THEN actual_value END) AS current_value, MAX(CASE WHEN monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = rml.indicator_id AND monitoring_date <= DATE(MAX(monitoring_date), '-30 day')) THEN actual_value END) AS value_30_days_ago, (MAX(CASE WHEN monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = rml.indicator_id) THEN actual_value END) - MAX(CASE WHEN monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = rml.indicator_id AND monitoring_date <= DATE(MAX(monitoring_date), '-30 day')) THEN actual_value END)) / MAX(CASE WHEN monitoring_date = (SELECT MAX(monitoring_date) FROM risk_monitoring_logs WHERE indicator_id = rml.indicator_id AND monitoring_date <= DATE(MAX(monitoring_date), '-30 day')) THEN actual_value END) * 100 AS change_percentage FROM risk_monitoring_logs rml GROUP BY indicator_id;
SELECT event_id FROM risk_assessments WHERE risk_level = '高风险' AND assessor = '曾强';
SELECT DISTINCT customer_id FROM transactions WHERE transaction_type = '投资' AND risk_score > 60;
SELECT created_at, status FROM risk_events;
SELECT c.customer_id, t.risk_score FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.credit_score < 600;
SELECT t.amount, c.customer_name FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.status = '成功' AND t.transaction_date LIKE '2023-12%';
SELECT alert_type, alert_content FROM alerts;
SELECT report_id, approved_by FROM risk_reports;
SELECT transaction_type, SUM(CASE WHEN status = '成功' THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS success_rate, AVG(risk_score) AS avg_risk_score FROM transactions GROUP BY transaction_type;
SELECT a.alert_id, r.rule_description FROM alerts a JOIN rule_configurations r ON a.rule_id = r.rule_id;
SELECT customer_id, customer_name, (SELECT status FROM transactions WHERE customer_id = customers.customer_id ORDER BY transaction_date DESC LIMIT 1) AS last_transaction_status FROM customers;
SELECT indicator_id, AVG(actual_value) AS avg_value, STDDEV(actual_value) AS stddev_value, STDDEV(actual_value)/AVG(actual_value) AS coefficient_of_variation FROM risk_monitoring_logs GROUP BY indicator_id;
SELECT DISTINCT t.customer_id FROM transactions t JOIN audit_logs a ON t.transaction_id = a.transaction_id WHERE t.risk_score > 80 AND t.amount > 500000 AND a.audit_result = '未通过' AND t.transaction_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);
SELECT AVG(impact_score) FROM risk_assessments WHERE mitigation_plan IS NULL;
SELECT alert_content, status FROM alerts;
SELECT customer_id, (COALESCE(high_risk_transactions, 0) * 2 + COALESCE(unresolved_alerts, 0) * 3 + (1 / NULLIF(credit_score, 0)) * 1000) AS risk_index FROM customers LEFT JOIN (SELECT customer_id, COUNT(*) AS high_risk_transactions FROM transactions WHERE risk_score > 50 AND transaction_date >= DATE('now', '-90 days') GROUP BY customer_id) AS t ON customers.customer_id = t.customer_id LEFT JOIN (SELECT assigned_to, COUNT(*) AS unresolved_alerts FROM alerts WHERE status = '未处理' GROUP BY assigned_to) AS a ON customers.customer_id = a.assigned_to ORDER BY risk_index DESC LIMIT 10;
SELECT event_type, COUNT(*) AS event_count, AVG(severity) AS avg_severity FROM risk_events WHERE SUBSTR(occurrence_time, 1, 4) = '2023' GROUP BY event_type ORDER BY event_count DESC;
SELECT r.report_id, r.report_content, e.event_id, e.event_description FROM risk_reports r JOIN risk_events e ON r.event_id = e.event_id WHERE r.report_content LIKE '%合规风险%';
SELECT update_frequency, data_source FROM risk_indicators;
SELECT re.event_id, rr.report_id FROM risk_events re JOIN (SELECT event_id, MAX(report_date) AS latest_date FROM risk_reports GROUP BY event_id) latest_rr ON re.event_id = latest_rr.event_id JOIN risk_reports rr ON latest_rr.event_id = rr.event_id AND latest_rr.latest_date = rr.report_date WHERE re.status != '已解决';
SELECT rule_type, AVG(trigger_count) AS avg_trigger_count, MAX(updated_at) AS last_updated FROM (SELECT rc.rule_type, rc.updated_at, COUNT(a.alert_id) AS trigger_count FROM rule_configurations rc LEFT JOIN alerts a ON rc.rule_id = a.rule_id GROUP BY rc.rule_type, rc.updated_at) AS subquery GROUP BY rule_type;
SELECT event_type, COUNT(event_id) FROM risk_events GROUP BY event_type ORDER BY COUNT(event_id) DESC;
SELECT customer_id FROM customers WHERE credit_score < 700 AND customer_id IN (SELECT customer_id FROM transactions WHERE transaction_date LIKE '2023%');
SELECT risk_events.event_id, risk_events.event_type, risk_events.event_description, risk_events.occurrence_time, risk_events.severity, risk_events.status, risk_events.reporter, risk_events.created_at, risk_reports.report_id, risk_reports.report_type, risk_reports.report_date, risk_reports.report_content, risk_reports.author, risk_reports.approval_status, risk_reports.approved_by FROM risk_events INNER JOIN risk_reports ON risk_events.event_id = risk_reports.event_id;
SELECT COUNT(*) FROM risk_reports WHERE YEAR(report_date) = 2023 AND approval_status = '拒绝';
SELECT assessment_id, mitigation_plan FROM risk_assessments;
SELECT * FROM risk_monitoring_logs WHERE (indicator_id, monitoring_date) IN (SELECT indicator_id, MAX(monitoring_date) FROM risk_monitoring_logs GROUP BY indicator_id);
SELECT rc.rule_id, rc.rule_name, COUNT(a.alert_id) AS alert_count FROM rule_configurations rc LEFT JOIN alerts a ON rc.rule_id = a.rule_id GROUP BY rc.rule_id, rc.rule_name;
SELECT * FROM transactions WHERE event_id IN (SELECT event_id FROM risk_events WHERE event_type = '信用风险') AND status = '成功';
SELECT risk_level, COUNT(*) FROM customers GROUP BY risk_level;
SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY total_amount) FROM (SELECT SUM(amount) AS total_amount FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE c.registration_date < '2019-01-01' AND c.risk_level = '高' GROUP BY t.customer_id) AS subquery;
SELECT a.rule_id, r.event_description FROM alerts a JOIN risk_events r ON a.event_id = r.event_id WHERE a.alert_level = '高风险';
SELECT created_at, status FROM risk_events;
SELECT event_type, DATE_FORMAT(occurrence_time, '%Y-%m') AS month, COUNT(*) AS frequency, (COUNT(*) - LAG(COUNT(*), 1, 0) OVER (PARTITION BY event_type ORDER BY DATE_FORMAT(occurrence_time, '%Y-%m'))) / LAG(COUNT(*), 1, 1) OVER (PARTITION BY event_type ORDER BY DATE_FORMAT(occurrence_time, '%Y-%m')) AS growth_rate FROM risk_events GROUP BY event_type, DATE_FORMAT(occurrence_time, '%Y-%m');
SELECT strftime('%Y-%m', transaction_date) AS month, AVG(amount) AS avg_amount, COUNT(transaction_id) AS transaction_count FROM transactions GROUP BY month;
SELECT report_id, report_type, approved_by, event_description, severity FROM risk_reports JOIN risk_events ON risk_reports.event_id = risk_events.event_id WHERE approval_status = '已批准';
SELECT c.risk_level, t.status FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id;
SELECT * FROM transactions WHERE customer_id IN (SELECT customer_id FROM customers WHERE risk_level = '高风险');
SELECT report_id FROM risk_reports WHERE author = '孙宇' AND approval_status = '未审批';
SELECT a.alert_content, r.event_description FROM alerts a JOIN risk_events r ON a.event_id = r.event_id WHERE a.status = '未处理';
SELECT risk_level, COUNT(*) FROM customers WHERE risk_level IN ('中', '高') GROUP BY risk_level;
SELECT customer_id, COUNT(*), AVG(risk_score) FROM transactions GROUP BY customer_id;
SELECT strftime('%Y-%m', registration_date) AS month, COUNT(*) FROM customers WHERE risk_level = '高风险' GROUP BY month;
SELECT rml.monitoring_date, rml.actual_value, a.alert_id, a.alert_type, al.audit_id, al.audit_result FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id JOIN (SELECT indicator_id, monitoring_date, actual_value, ROW_NUMBER() OVER (PARTITION BY indicator_id ORDER BY monitoring_date DESC) AS rn FROM risk_monitoring_logs) latest ON rml.indicator_id = latest.indicator_id AND rml.monitoring_date = latest.monitoring_date AND latest.rn = 1 LEFT JOIN alerts a ON rml.event_id = a.event_id LEFT JOIN audit_logs al ON a.alert_id = al.alert_id WHERE ri.risk_level = '高风险';
SELECT risk_level, COUNT(*) AS customer_count, AVG(credit_score) AS avg_credit_score FROM customers GROUP BY risk_level;
SELECT alert_type FROM alerts JOIN audit_logs ON alerts.alert_id = audit_logs.alert_id WHERE alerts.status = '已解决' GROUP BY alert_type ORDER BY MAX(STRFTIME('%s', audit_logs.audit_time) - STRFTIME('%s', alerts.alert_time)) DESC LIMIT 1;
SELECT customers.customer_name, transactions.amount, transactions.transaction_date FROM transactions JOIN customers ON transactions.customer_id = customers.customer_id WHERE transactions.transaction_date BETWEEN '2023-11-01' AND '2023-11-30' AND transactions.amount > 100000;
SELECT SUM(threshold_value) FROM risk_indicators WHERE indicator_name LIKE '%财务%';
SELECT customer_name, credit_score FROM customers;
SELECT customer_id, risk_score FROM transactions WHERE (customer_id, transaction_date) IN (SELECT customer_id, MAX(transaction_date) FROM transactions GROUP BY customer_id);
SELECT * FROM risk_monitoring_logs logs JOIN risk_indicators indicators ON logs.indicator_id = indicators.indicator_id WHERE logs.actual_value > indicators.threshold_value;
SELECT AVG(t.risk_score) FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE c.risk_level = '高风险';
SELECT transaction_id, customer_id, transaction_type, amount, transaction_date, status, risk_score FROM transactions;
SELECT report_type, COUNT(*) FROM risk_reports WHERE approval_status = '已拒绝' GROUP BY report_type;
SELECT customer_name FROM customers WHERE risk_level = '高' AND credit_score < 600;
SELECT c.risk_level, AVG(t.amount) AS avg_amount, COUNT(t.transaction_id) AS transaction_count FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.transaction_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY c.risk_level;
SELECT report_id, report_content FROM risk_reports WHERE event_id IN (SELECT event_id FROM risk_events WHERE event_type = '流动性风险');
SELECT COUNT(DISTINCT c.customer_id) AS customer_count, SUM(t.amount) AS total_amount FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE c.credit_score BETWEEN 600 AND 800;
SELECT report_content FROM risk_reports WHERE approved_by = '王思远' AND strftime('%Y-%m', report_date) = '2023-03';
SELECT risk_events.*, risk_reports.* FROM risk_events JOIN risk_reports ON risk_events.event_id = risk_reports.event_id;
SELECT * FROM transactions WHERE transaction_date LIKE '2023-06%';
SELECT event_id FROM risk_events WHERE severity = 3 AND event_id IN (SELECT event_id FROM audit_logs);
SELECT ri.threshold_value, rml.actual_value FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id WHERE rml.actual_value > ri.threshold_value;
SELECT c.customer_id, c.credit_score, t.status FROM customers c JOIN transactions t ON c.customer_id = t.customer_id;
SELECT re.event_id, re.event_type, a.alert_id, a.alert_content FROM risk_events re JOIN alerts a ON re.event_id = a.event_id WHERE a.alert_level = '高';
SELECT * FROM risk_events JOIN alerts ON risk_events.event_id = alerts.event_id ORDER BY alerts.alert_time;
SELECT risk_level, AVG(amount) AS avg_amount, COUNT(*) AS transaction_count FROM customers JOIN transactions ON customers.customer_id = transactions.customer_id WHERE transaction_date >= DATE('now', '-90 days') GROUP BY risk_level;
SELECT customer_name FROM customers WHERE risk_level = '高' AND credit_score < 700;
SELECT c.credit_score, t.transaction_id, t.transaction_type, t.amount, t.transaction_date FROM customers c JOIN (SELECT customer_id, transaction_id, transaction_type, amount, transaction_date FROM transactions WHERE status = '失败' ORDER BY transaction_date DESC) t ON c.customer_id = t.customer_id GROUP BY c.customer_id;
SELECT ra.event_id FROM risk_assessments ra JOIN customers c ON ra.event_id = c.event_id WHERE ra.risk_level = '高风险' AND c.credit_score > 700;
SELECT * FROM customers WHERE customer_type = '企业' ORDER BY credit_score DESC LIMIT 10;
SELECT strftime('%Y-%m', created_at) AS month, COUNT(*) AS new_rules, AVG(CASE WHEN is_active = '是' THEN 1 ELSE 0 END) AS avg_active_rules FROM rule_configurations GROUP BY strftime('%Y-%m', created_at);
SELECT author, approval_status FROM risk_reports WHERE approval_status = '已批准';
SELECT customer_id, amount, status FROM transactions;
SELECT re.event_id, re.event_type, re.event_description, re.occurrence_time, re.severity, re.status, re.reporter, re.created_at, ra.assessment_id, ra.assessor, ra.assessment_date, ra.risk_level, ra.impact_score, ra.probability_score, ra.mitigation_plan FROM risk_events re LEFT JOIN risk_assessments ra ON re.event_id = ra.event_id;
SELECT ri.indicator_id, AVG(rml.actual_value) AS avg_actual_value, ri.threshold_value FROM risk_indicators ri JOIN risk_monitoring_logs rml ON ri.indicator_id = rml.indicator_id GROUP BY ri.indicator_id, ri.threshold_value;
SELECT risk_reports.report_id, risk_reports.report_type, risk_reports.report_date, risk_reports.report_content, risk_reports.author, risk_events.event_id, risk_events.event_type, risk_events.event_description, risk_events.occurrence_time, risk_events.severity, risk_events.status, risk_events.reporter FROM risk_reports JOIN risk_events ON risk_reports.event_id = risk_events.event_id WHERE risk_reports.approval_status = '已批准';
SELECT DISTINCT t.customer_id FROM transactions t JOIN alerts a ON t.customer_id = a.assigned_to AND t.transaction_date = a.alert_time WHERE t.risk_score > 7 AND a.alert_level = '高级别';
SELECT t.transaction_id, t.customer_id, t.transaction_type, t.amount, t.transaction_date, t.status, t.risk_score, t.event_id, c.customer_name, c.customer_type, c.credit_score, c.risk_level, c.registration_date, c.last_update_date FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.risk_score > 80;
SELECT risk_events.event_description, risk_assessments.assessment_date FROM risk_assessments JOIN risk_events ON risk_assessments.event_id = risk_events.event_id WHERE risk_assessments.risk_level = '高';
SELECT c.customer_id FROM customers c JOIN (SELECT t.customer_id, MAX(t.transaction_date) AS last_transaction_date FROM transactions t GROUP BY t.customer_id) AS last_trans ON c.customer_id = last_trans.customer_id JOIN transactions t ON last_trans.customer_id = t.customer_id AND last_trans.last_transaction_date = t.transaction_date WHERE c.risk_level = '高风险' AND t.status = '失败';
SELECT event_id, COUNT(*) FROM transactions GROUP BY event_id;
SELECT t.transaction_id, t.customer_id, t.transaction_type, t.amount, t.transaction_date, c.customer_name, c.customer_type FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.transaction_date BETWEEN '2023-01-01' AND '2023-03-31' AND c.risk_level = '高风险' AND t.amount > 500000;
SELECT re.event_description, re.severity, ra.risk_level, ra.mitigation_plan FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE re.severity IN (4, 5) AND re.occurrence_time LIKE '2023%';
SELECT * FROM risk_monitoring_logs WHERE is_exceeding_threshold = '否';
SELECT rr.author, re.event_type, re.event_description, re.occurrence_time, al.audit_result, al.audit_comments FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id LEFT JOIN (SELECT * FROM audit_logs WHERE audit_type = '风险报告' ORDER BY audit_time DESC LIMIT 1) al ON rr.report_id = al.related_id WHERE rr.approval_status = '待审批';
SELECT customer_id FROM customers WHERE YEAR(registration_date) = 2021 AND risk_level = '高' AND credit_score < 550;
SELECT t.customer_id, t.transaction_id, t.transaction_type, t.amount, t.transaction_date, t.status, t.risk_score, a.alert_id FROM (SELECT customer_id, MAX(transaction_date) AS latest_transaction_date FROM transactions GROUP BY customer_id) AS latest_transactions JOIN transactions t ON latest_transactions.customer_id = t.customer_id AND latest_transactions.latest_transaction_date = t.transaction_date LEFT JOIN alerts a ON t.transaction_id = a.event_id;
SELECT event_type, COUNT(*) FROM risk_events GROUP BY event_type;
SELECT c.customer_name, r.rule_name, COUNT(a.alert_id) AS trigger_count FROM customers c JOIN alerts a ON c.customer_id = a.assigned_to JOIN rule_configurations r ON a.rule_id = r.rule_id WHERE c.risk_level = '高' GROUP BY c.customer_name, r.rule_name;
SELECT event_type, strftime('%Y-%m', occurrence_time) AS month, COUNT(event_id) AS event_count, AVG(severity) AS avg_severity, SUM(CASE WHEN status = '已解决' THEN 1 ELSE 0 END) * 1.0 / COUNT(event_id) AS resolution_rate FROM risk_events GROUP BY event_type, month;
SELECT actual_value, threshold_value FROM risk_monitoring_logs JOIN risk_indicators ON risk_monitoring_logs.indicator_id = risk_indicators.indicator_id;
SELECT c.risk_level, t.transaction_type, AVG(t.amount) FROM customers c JOIN transactions t ON c.customer_id = t.customer_id GROUP BY c.risk_level, t.transaction_type;
SELECT COUNT(*) FROM rule_configurations WHERE is_active = '激活';
SELECT risk_level, credit_score FROM customers;
SELECT COUNT(*), AVG(update_frequency) FROM risk_indicators WHERE threshold_value > 100;
SELECT customer_name, registration_date FROM customers;
SELECT indicator_id, actual_value, is_exceeding_threshold FROM risk_monitoring_logs;
SELECT indicator_id, data_source, AVG(actual_value) AS avg_value, STDDEV(actual_value) AS stddev_value FROM risk_monitoring_logs GROUP BY indicator_id, data_source;
SELECT auditor FROM audit_logs WHERE audit_result = '拒绝';
SELECT alert_type, alert_content FROM alerts;
SELECT a.alert_id, a.alert_content, a.alert_time, e.event_description, l.audit_result, l.audit_comments FROM alerts a JOIN risk_events e ON a.event_id = e.event_id LEFT JOIN (SELECT * FROM audit_logs WHERE audit_time = (SELECT MAX(audit_time) FROM audit_logs al WHERE al.alert_id = audit_logs.alert_id)) l ON a.alert_id = l.alert_id WHERE a.status = '未处理';
SELECT AVG(alert_time) FROM alerts WHERE status = '未处理';
SELECT c.customer_id, COUNT(a.assessment_id) * AVG(t.risk_score) + COUNT(al.alert_id) * 2 AS risk_index FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id LEFT JOIN risk_assessments a ON t.event_id = a.event_id LEFT JOIN alerts al ON t.event_id = al.event_id GROUP BY c.customer_id;
SELECT event_type, COUNT(*) FROM risk_events WHERE status = '未处理' GROUP BY event_type;
SELECT * FROM transactions WHERE customer_id IN (SELECT customer_id FROM customers WHERE risk_level = '低' AND credit_score > 700);
SELECT a.alert_id, a.alert_type, a.alert_content, a.alert_level, a.alert_time, a.status, e.event_id, e.event_type, e.event_description, e.occurrence_time, e.severity, e.status FROM alerts a JOIN risk_events e ON a.event_id = e.event_id WHERE a.status = '未处理' AND a.alert_level = '高级别';
SELECT alert_id, status FROM alerts WHERE rule_id IN (SELECT rule_id FROM rule_configurations WHERE rule_type = '合规违规');
SELECT c.customer_id, c.risk_level, SUM(t.amount) AS total_amount FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.risk_score = '高' GROUP BY c.customer_id, c.risk_level;
SELECT report_content FROM risk_reports WHERE report_type = '月度风险报告' AND approval_status = '已拒绝';
SELECT event_type, COUNT(*) FROM risk_events GROUP BY event_type;
SELECT customer_id FROM transactions WHERE transaction_date = '2023-05-04' AND transaction_type = '转账' AND amount > 200000;
SELECT a.alert_id, r.event_description, a.assigned_to FROM alerts a JOIN risk_events r ON a.event_id = r.event_id WHERE a.status = '未处理' AND a.alert_level = '高级别';
SELECT report_id FROM risk_reports WHERE report_date LIKE '2023-04%' AND approved_by = '高志远';
SELECT transaction_type, status, COUNT(*) FROM transactions GROUP BY transaction_type, status;
SELECT re.event_id, re.event_type, re.event_description, ra.risk_level, ra.impact_score, ra.probability_score FROM risk_events re LEFT JOIN (SELECT event_id, risk_level, impact_score, probability_score FROM risk_assessments WHERE (event_id, assessment_date) IN (SELECT event_id, MAX(assessment_date) FROM risk_assessments GROUP BY event_id)) ra ON re.event_id = ra.event_id;
SELECT c.customer_name, COUNT(DISTINCT ra.assessment_id) AS risk_assessment_count, COUNT(DISTINCT t.transaction_id) AS large_transaction_count FROM customers c JOIN risk_assessments ra ON c.customer_id = ra.event_id JOIN transactions t ON c.customer_id = t.customer_id WHERE ra.risk_level = '高风险' AND t.amount > 500000 AND ra.assessment_date >= DATEADD(year, -1, GETDATE()) AND t.transaction_date >= DATEADD(year, -1, GETDATE()) GROUP BY c.customer_name;
SELECT * FROM transactions WHERE customer_id = (SELECT customer_id FROM customers WHERE customer_name = '恒基能源有限公司');
SELECT event_id, MAX(severity) FROM risk_events GROUP BY event_id;
SELECT c.risk_level, COUNT(DISTINCT c.customer_id) AS customer_count, AVG(t.amount) AS avg_transaction_amount FROM customers c JOIN transactions t ON c.customer_id = t.customer_id GROUP BY c.risk_level;
SELECT a.alert_id, a.rule_id, a.alert_type, a.alert_content, a.alert_level, a.alert_time, a.status, a.assigned_to, a.event_id, l.audit_result FROM alerts a JOIN audit_logs l ON a.alert_id = l.alert_id WHERE l.auditor = '张强';
SELECT risk_monitoring_logs.actual_value, risk_monitoring_logs.is_exceeding_threshold, risk_indicators.indicator_name FROM risk_monitoring_logs JOIN risk_indicators ON risk_monitoring_logs.indicator_id = risk_indicators.indicator_id;
SELECT indicator_id, COUNT(*) AS exceed_count, AVG(actual_value - threshold_value) AS avg_exceed_value FROM risk_monitoring_logs JOIN risk_indicators USING (indicator_id) WHERE is_exceeding_threshold = '是' AND strftime('%Y', monitoring_date) = '2023' GROUP BY indicator_id;
SELECT alert_id, status FROM alerts WHERE alert_time LIKE '2023%';
SELECT indicator_id, actual_value FROM risk_monitoring_logs WHERE (indicator_id, monitoring_date) IN (SELECT indicator_id, MAX(monitoring_date) FROM risk_monitoring_logs GROUP BY indicator_id);
SELECT indicator_id, COUNT(*) AS exceed_count, COUNT(*) * 100.0 / (SELECT COUNT(*) FROM risk_monitoring_logs WHERE indicator_id = rml.indicator_id AND monitoring_date >= DATE('now', '-1 year')) AS exceed_percentage FROM risk_monitoring_logs rml WHERE is_exceeding_threshold = '是' AND monitoring_date >= DATE('now', '-1 year') GROUP BY indicator_id ORDER BY exceed_count DESC LIMIT 10;
SELECT risk_level, COUNT(*) FROM customers GROUP BY risk_level;
SELECT customer_id, risk_score, status FROM transactions;
SELECT ra.event_id FROM risk_assessments ra JOIN transactions t ON ra.event_id = t.event_id WHERE ra.risk_level = '高风险' AND t.risk_score < 50;
SELECT transaction_type FROM transactions WHERE status = '成功' GROUP BY transaction_type ORDER BY COUNT(*) DESC LIMIT 1;
SELECT * FROM transactions WHERE status = '失败' AND event_id IN (SELECT event_id FROM risk_events WHERE status = '已解决');
SELECT t.transaction_id, c.customer_name, c.customer_type FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.status = '处理中';
SELECT t.transaction_id, t.amount, t.transaction_date, r.event_id, r.event_type, r.event_description FROM transactions t JOIN risk_events r ON t.event_id = r.event_id WHERE t.amount > 1000;
SELECT t.transaction_id, r.event_id, r.event_type, r.event_description, r.occurrence_time, r.severity, r.status, r.reporter, r.created_at FROM transactions t JOIN customers c ON t.customer_id = c.customer_id JOIN risk_events r ON t.event_id = r.event_id WHERE t.amount > 100000 AND c.risk_level = '高' AND t.transaction_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);
SELECT * FROM risk_assessments WHERE mitigation_plan IS NOT NULL;
SELECT transaction_id, customer_id, transaction_type, amount, transaction_date, status, risk_score FROM transactions WHERE customer_id IN (SELECT customer_id FROM customers WHERE risk_level = '高风险');
SELECT rml.actual_value, ri.indicator_name FROM risk_monitoring_logs rml JOIN risk_indicators ri ON rml.indicator_id = ri.indicator_id WHERE rml.actual_value < ri.threshold_value;
SELECT event_type, status FROM risk_reports JOIN risk_events ON risk_reports.event_id = risk_events.event_id WHERE approval_status = '已拒绝';
SELECT DISTINCT c.customer_id FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE YEAR(c.registration_date) = 2021 AND c.credit_score > 700 AND t.transaction_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);
SELECT a.alert_id, r.event_type, t.transaction_id FROM alerts a JOIN risk_events r ON a.event_id = r.event_id JOIN transactions t ON a.event_id = t.event_id WHERE a.assigned_to = '陈强';
SELECT * FROM risk_reports WHERE report_content LIKE '%合规%';
SELECT DATE_FORMAT(risk_events.occurrence_time, '%Y-%m') AS month, COUNT(risk_events.event_id) AS event_count, AVG(risk_events.severity) AS avg_severity, COUNT(alerts.alert_id) AS alert_count FROM risk_events LEFT JOIN alerts ON risk_events.event_id = alerts.event_id GROUP BY month;
SELECT indicator_name, threshold_value FROM risk_indicators;
SELECT indicator_id, monitoring_date, actual_value, is_exceeding_threshold FROM risk_monitoring_logs WHERE (indicator_id, monitoring_date) IN (SELECT indicator_id, MAX(monitoring_date) FROM risk_monitoring_logs GROUP BY indicator_id);
SELECT t.*, c.* FROM transactions t JOIN customers c ON t.customer_id = c.customer_id WHERE t.amount > 100000;
SELECT * FROM risk_reports WHERE approval_status = '已批准';
SELECT transaction_type, AVG(risk_score) FROM transactions GROUP BY transaction_type;
SELECT event_type, AVG(JULIANDAY(CASE WHEN status = '已解决' THEN occurrence_time ELSE NULL END) - JULIANDAY(created_at)) AS avg_resolution_time, AVG(JULIANDAY(CASE WHEN status = '未处理' THEN occurrence_time ELSE NULL END) - JULIANDAY(created_at)) AS avg_unprocessed_duration, AVG(JULIANDAY(CASE WHEN status = '处理中' THEN occurrence_time ELSE NULL END) - JULIANDAY(created_at)) AS avg_processing_duration FROM risk_events GROUP BY event_type;
SELECT alert_type, COUNT(*) AS alert_count, AVG(STRFTIME('%s', audit_time) - STRFTIME('%s', alert_time)) AS avg_processing_time FROM alerts JOIN audit_logs ON alerts.alert_id = audit_logs.alert_id WHERE alerts.status = '已处理' GROUP BY alert_type;
SELECT event_type, AVG(TIMESTAMPDIFF(SECOND, created_at, (SELECT MIN(occurrence_time) FROM risk_events WHERE status = '已解决' AND event_type = re.event_type))) AS avg_processing_time FROM risk_events re GROUP BY event_type;
SELECT a.alert_id, a.rule_id, r.status FROM alerts a JOIN risk_events r ON a.event_id = r.event_id;
SELECT c.customer_name, COUNT(DISTINCT t.transaction_id) AS high_risk_transaction_count, COUNT(DISTINCT a.alert_id) AS high_level_alert_count FROM customers c JOIN transactions t ON c.customer_id = t.customer_id AND t.risk_score > 80 AND strftime('%Y', t.transaction_date) = '2023' JOIN alerts a ON c.customer_id = a.assigned_to AND a.alert_level = '高级' GROUP BY c.customer_name;
SELECT re.severity, ra.risk_level FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id;
SELECT * FROM transactions WHERE event_id = '特定风险事件ID';
SELECT customer_type, COUNT(*) FROM customers GROUP BY customer_type;
SELECT ra.assessment_id, ra.event_id, ra.assessor, ra.assessment_date, ra.risk_level, ra.impact_score, ra.probability_score, ra.mitigation_plan, re.event_type, re.event_description, re.occurrence_time, re.severity, re.status, re.reporter, re.created_at FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id;
SELECT c.customer_id FROM customers c LEFT JOIN transactions t ON c.customer_id = t.customer_id AND t.transaction_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) WHERE c.risk_level = '高风险' AND t.transaction_id IS NULL;
SELECT c.customer_name, c.risk_level, t.transaction_date, t.amount, t.risk_score FROM customers c JOIN (SELECT customer_id, MAX(transaction_date) AS transaction_date FROM transactions GROUP BY customer_id) AS latest_tx ON c.customer_id = latest_tx.customer_id JOIN transactions t ON latest_tx.customer_id = t.customer_id AND latest_tx.transaction_date = t.transaction_date WHERE c.risk_level = '高风险';
SELECT transaction_type, COUNT(*) AS total_transactions, COUNT(CASE WHEN status = '成功' THEN 1 END) * 1.0 / COUNT(*) AS success_rate FROM transactions GROUP BY transaction_type;
SELECT event_id, mitigation_plan, assessor FROM risk_assessments WHERE risk_level = '高';
SELECT customer_id FROM customers WHERE risk_level = '高' AND credit_score < 700;
SELECT customer_id, customer_name FROM customers WHERE risk_level = '高' AND credit_score < 600;
SELECT c.risk_level, SUM(t.amount) FROM customers c JOIN transactions t ON c.customer_id = t.customer_id WHERE t.status = '成功' GROUP BY c.risk_level;
SELECT rr.report_id, rr.report_type, rr.report_date, rr.report_content, rr.author, re.event_type, re.event_description, re.occurrence_time, re.severity, re.status FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.approval_status = '已批准';
SELECT author FROM risk_reports GROUP BY author ORDER BY COUNT(*) DESC LIMIT 1;
SELECT event_id, reporter FROM risk_events WHERE status = '未处理';
SELECT customer_name, last_update_date FROM customers WHERE registration_date > '2021-01-01';
SELECT rr.report_id, rr.report_type, rr.report_date, rr.report_content, rr.author, rr.approval_status, re.event_id, re.event_type, re.event_description, re.occurrence_time, re.severity, re.status, re.reporter, re.created_at FROM risk_reports rr JOIN risk_events re ON rr.event_id = re.event_id WHERE rr.approved_by = '高志远';
SELECT ri.indicator_id, rml.actual_value, ri.threshold_value, rml.monitoring_date FROM risk_indicators ri JOIN (SELECT indicator_id, MAX(monitoring_date) AS latest_date FROM risk_monitoring_logs GROUP BY indicator_id) latest ON ri.indicator_id = latest.indicator_id JOIN risk_monitoring_logs rml ON latest.indicator_id = rml.indicator_id AND latest.latest_date = rml.monitoring_date;
SELECT * FROM risk_monitoring_logs JOIN risk_indicators ON risk_monitoring_logs.indicator_id = risk_indicators.indicator_id;
SELECT AVG(impact_score), AVG(probability_score) FROM risk_assessments;
SELECT re.event_id, re.event_type, ra.assessment_id, ra.assessor FROM risk_events re JOIN risk_assessments ra ON re.event_id = ra.event_id WHERE ra.assessor IS NOT NULL;
SELECT SUM(amount) FROM transactions WHERE transaction_type = '退款';
SELECT ri.indicator_id, rml.monitoring_date FROM risk_indicators ri LEFT JOIN (SELECT indicator_id, MAX(monitoring_date) AS monitoring_date FROM risk_monitoring_logs GROUP BY indicator_id) rml ON ri.indicator_id = rml.indicator_id;
SELECT event_type, AVG(JULIANDAY(assessment_date) - JULIANDAY(occurrence_time)) AS avg_mitigation_time FROM risk_events JOIN risk_assessments USING(event_id) GROUP BY event_type;
SELECT event_type, COUNT(*) FROM risk_events GROUP BY event_type;
SELECT ra.assessment_id, ra.event_id, ra.assessor, re.event_type, re.event_description FROM risk_assessments ra JOIN risk_events re ON ra.event_id = re.event_id;
SELECT COUNT(*) FROM risk_monitoring_logs WHERE is_exceeding_threshold = '是';
SELECT risk_level, mitigation_plan FROM risk_assessments;
SELECT report_id, author FROM risk_reports WHERE approval_status = '已批准';
SELECT customer_id, customer_name FROM customers WHERE risk_level = '高' AND credit_score > (SELECT AVG(credit_score) FROM customers);
SELECT alert_content, assigned_to FROM alerts;
SELECT event_description, severity, created_at, audit_time FROM risk_events JOIN audit_logs ON risk_events.event_id = audit_logs.event_id WHERE risk_events.status = '已解决' AND audit_logs.audit_type = '解决' ORDER BY audit_time DESC LIMIT 10;
SELECT rc.rule_id, rc.rule_name, rc.rule_description, rc.rule_type, rc.rule_condition, rc.rule_action, ri.indicator_id, ri.indicator_name, ri.indicator_description, ri.measurement_unit, ri.threshold_value, ri.data_source, ri.update_frequency FROM rule_configurations rc JOIN risk_indicators ri ON rc.indicator_id = ri.indicator_id WHERE rc.is_active = '激活';
SELECT risk_level, COUNT(*) FROM customers GROUP BY risk_level;
SELECT event_id, reporter FROM risk_events WHERE status = '未处理';
SELECT event_id, created_at FROM risk_events WHERE severity >= 3;
SELECT mitigation_plan, assessor FROM risk_assessments;
SELECT a.alert_id, r.event_description, l.audit_comments FROM alerts a JOIN risk_events r ON a.event_id = r.event_id JOIN (SELECT alert_id, audit_comments FROM audit_logs WHERE alert_id IS NOT NULL ORDER BY audit_time DESC LIMIT 1) l ON a.alert_id = l.alert_id WHERE a.status = '未解决' AND a.alert_level = '高级别';
SELECT event_id, mitigation_plan FROM risk_assessments WHERE risk_level = '高';
SELECT customer_id FROM customers WHERE risk_level = '高风险' AND customer_id IN (SELECT customer_id FROM transactions WHERE amount > 100000 AND transaction_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR));
SELECT assessment_id FROM risk_assessments WHERE impact_score > 8 AND risk_level = '高';
SELECT risk_events.event_id, risk_reports.report_type, risk_reports.report_content FROM risk_events JOIN risk_reports ON risk_events.event_id = risk_reports.event_id;
SELECT DISTINCT fii.institution_name FROM financial_institution_info fii JOIN regulatory_reports rr ON fii.institution_id = rr.institution_id JOIN non_performing_loans npl ON fii.institution_id = npl.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND npl.npl_ratio > 2 AND rr.report_date BETWEEN '2023-07-01' AND '2023-09-30';
SELECT * FROM regulatory_reports WHERE submission_date = '2023-11-01';
SELECT DISTINCT car.institution_id FROM capital_adequacy_ratio car JOIN non_performing_loans npl ON car.institution_id = npl.institution_id AND car.report_date = npl.report_date WHERE car.total_car < 12 AND npl.npl_ratio > 2 AND car.report_date = '2023-06-01';
SELECT fi.institution_name FROM risk_exposure re JOIN financial_institution_info fi ON re.institution_id = fi.institution_id ORDER BY (re.market_risk_exposure / re.total_risk_exposure) DESC LIMIT 1;
SELECT fi.institution_name FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND fi.registered_capital > 50000000 AND rr.report_date BETWEEN '2023-07-01' AND '2023-09-30';
SELECT institution_name, risk_weighted_assets / total_assets AS risk_weighted_asset_density FROM financial_institution_info JOIN balance_sheet USING (institution_id) JOIN capital_adequacy_ratio USING (institution_id) ORDER BY risk_weighted_asset_density DESC LIMIT 1;
SELECT liquidity_coverage_ratio, net_stable_funding_ratio FROM liquidity_ratio;
SELECT institution_id FROM compliance_records WHERE report_date >= '2023-12-01' AND report_date < '2024-01-01' AND status = '未解决';
SELECT institution_id, loans_and_advances, deposits FROM balance_sheet WHERE YEAR(report_date) = 2024;
SELECT * FROM balance_sheet WHERE report_date = '2039-06-08';
SELECT COUNT(DISTINCT institution_id) FROM non_performing_loans WHERE npl_ratio > 3;
SELECT net_interest_income, non_interest_income FROM income_statement WHERE report_date = '2023-03-01';
SELECT npl_amount / total_loans FROM non_performing_loans;
SELECT DISTINCT rr.institution_id FROM regulatory_reports rr JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND YEAR(rr.report_date) = 2023 AND npl.npl_ratio > 1 AND YEAR(npl.report_date) = 2023;
SELECT institution_id FROM regulatory_reports WHERE report_date = '2023-10-01' AND report_type = '半年度报告' AND approval_status = '待审核';
SELECT institution_name FROM financial_institution_info WHERE institution_type = '非银行' ORDER BY registered_capital DESC LIMIT 5;
SELECT COUNT(DISTINCT b.institution_id) FROM balance_sheet b JOIN non_performing_loans n ON b.institution_id = n.institution_id WHERE b.institution_id IN (SELECT institution_id FROM balance_sheet ORDER BY total_assets DESC LIMIT 500) AND n.npl_ratio < 1 AND n.provision_coverage_ratio > 200;
SELECT fi.institution_name FROM financial_institution_info fi JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id WHERE car.core_tier_1_ratio < 10 AND rr.approval_status = '待审核' AND car.report_date = '2023-12-01' AND rr.report_date = '2023-12-01';
SELECT institution_name FROM (SELECT i.institution_name, (MAX(net_interest_income) - MIN(net_interest_income)) / MIN(net_interest_income) AS revenue_growth, (MAX(net_profit) - MIN(net_profit)) / MIN(net_profit) AS profit_growth FROM income_statement s JOIN financial_institution_info i ON s.institution_id = i.institution_id WHERE s.report_date >= DATE_SUB(CURDATE(), INTERVAL 2 YEAR) GROUP BY s.institution_id ORDER BY revenue_growth DESC, profit_growth ASC LIMIT 1) AS growth_rates;
SELECT approval_status FROM regulatory_reports WHERE report_date = '2023-07-01';
SELECT institution_id FROM capital_adequacy_ratio WHERE core_tier_1_ratio > (SELECT AVG(core_tier_1_ratio) FROM capital_adequacy_ratio) AND tier_1_ratio > (SELECT AVG(tier_1_ratio) FROM capital_adequacy_ratio) AND total_car > (SELECT AVG(total_car) FROM capital_adequacy_ratio);
SELECT * FROM compliance_records WHERE YEAR(record_date) = 2023 AND status = '已解决';
SELECT report_type FROM regulatory_reports WHERE report_date >= '2023-07-01' AND report_date <= '2023-09-30' GROUP BY report_type ORDER BY COUNT(*) DESC LIMIT 1;
SELECT tier_1_ratio FROM capital_adequacy_ratio;
SELECT institution_name, report_date FROM liquidity_ratio JOIN financial_institution_info ON liquidity_ratio.institution_id = financial_institution_info.institution_id WHERE liquidity_coverage_ratio > 100;
SELECT b.institution_id, STDDEV(b.total_liabilities / b.total_assets) AS asset_liability_stddev, l.liquidity_coverage_ratio FROM balance_sheet b JOIN liquidity_ratio l ON b.institution_id = l.institution_id AND b.report_date = l.report_date WHERE b.report_date >= DATE_SUB(CURDATE(), INTERVAL 2 YEAR) GROUP BY b.institution_id ORDER BY asset_liability_stddev DESC LIMIT 5;
SELECT compliance_type, severity FROM compliance_records WHERE record_date >= '2023-03-01' AND record_date < '2023-04-01';
SELECT institution_id, compliance_type, description, severity, status FROM compliance_records WHERE YEAR(record_date) = 2024;
SELECT report_type FROM regulatory_reports WHERE report_date = '2023-10-01';
SELECT * FROM compliance_records WHERE YEAR(record_date) = 2023 AND severity = '中';
SELECT description, status FROM compliance_records WHERE record_date = '2023-10-01';
SELECT institution_id FROM liquidity_ratio WHERE liquidity_coverage_ratio > (SELECT AVG(liquidity_coverage_ratio) FROM liquidity_ratio) AND net_stable_funding_ratio > (SELECT AVG(net_stable_funding_ratio) FROM liquidity_ratio) AND loan_to_deposit_ratio > (SELECT AVG(loan_to_deposit_ratio) FROM liquidity_ratio);
SELECT fi.institution_name, rr.report_type, rr.submission_date FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE rr.report_date BETWEEN '2023-07-01' AND '2023-09-30' AND rr.approval_status = '需修改' ORDER BY rr.submission_date DESC;
SELECT institution_id FROM capital_adequacy_ratio WHERE total_car < (SELECT PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY total_car) FROM capital_adequacy_ratio) AND institution_id IN (SELECT institution_id FROM non_performing_loans WHERE npl_ratio < (SELECT AVG(npl_ratio) FROM non_performing_loans));
SELECT registered_capital, institution_type FROM financial_institution_info;
SELECT establishment_date, legal_representative FROM financial_institution_info;
SELECT * FROM compliance_records WHERE status = '已解决';
SELECT DISTINCT fii.institution_name FROM regulatory_reports rr JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id WHERE rr.report_date = '2023-07-01' AND rr.approval_status = '需修改' AND npl.report_date = '2023-07-01' AND npl.npl_ratio > 1;
SELECT institution_name FROM financial_institution_info WHERE institution_id = (SELECT institution_id FROM balance_sheet ORDER BY ABS(loans_and_advances / deposits - 1) LIMIT 1);
SELECT fi.* FROM financial_institution_info fi JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE npl.total_loans > 100000000000;
SELECT cash_and_equivalents FROM balance_sheet WHERE report_date = '2026-04-27';
SELECT institution_id FROM capital_adequacy_ratio WHERE core_tier_1_ratio < 9;
SELECT DISTINCT fi.institution_name FROM regulatory_reports rr JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE YEAR(rr.report_date) = 2023 AND rr.report_type = '季度报告' AND rr.approval_status = '已拒绝' AND YEAR(npl.report_date) = 2023 AND npl.npl_ratio > 2;
SELECT COUNT(DISTINCT r.institution_id) FROM (SELECT c.institution_id FROM capital_adequacy_ratio c JOIN balance_sheet b ON c.institution_id = b.institution_id AND c.report_date = b.report_date ORDER BY (c.risk_weighted_assets / b.total_assets) DESC LIMIT 10) AS top_institutions JOIN risk_exposure r ON top_institutions.institution_id = r.institution_id WHERE r.market_risk_exposure > 1000;
SELECT AVG(branch_count) FROM financial_institution_info;
SELECT DISTINCT re.institution_id FROM risk_exposure re JOIN capital_adequacy_ratio car ON re.institution_id = car.institution_id WHERE (re.market_risk_exposure / re.total_risk_exposure) > 0.2 AND car.core_tier_1_ratio < 8.5;
SELECT fi.institution_name, car.core_tier_1_ratio, car.tier_1_ratio, car.total_car FROM financial_institution_info fi JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id WHERE car.report_date = '2023-12-01' AND car.core_tier_1_ratio < 10 AND car.total_car < 12;
SELECT COUNT(*) FROM compliance_records WHERE YEAR(record_date) = 2023 AND severity = '高';
SELECT fi.institution_name FROM balance_sheet bs JOIN financial_institution_info fi ON bs.institution_id = fi.institution_id ORDER BY (bs.cash_and_equivalents / bs.total_assets) DESC LIMIT 1;
SELECT institution_id FROM risk_exposure WHERE (market_risk_exposure / total_risk_exposure) > 0.4;
SELECT institution_id FROM regulatory_reports WHERE YEAR(report_date) = 2023 AND approval_status = '已批准' GROUP BY institution_id ORDER BY COUNT(*) DESC LIMIT 1;
SELECT fi.institution_name FROM financial_institution_info fi JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id WHERE YEAR(car.report_date) = 2023 AND car.core_tier_1_ratio < 8 AND rr.approval_status = '已批准';
SELECT credit_risk_exposure, operational_risk_exposure FROM risk_exposure WHERE report_date >= '2024-01-01' AND report_date < '2024-02-01';
SELECT description, severity FROM compliance_records WHERE record_date = '2023-04-02';
SELECT report_date, npl_ratio FROM non_performing_loans ORDER BY report_date;
SELECT institution_id, provision_coverage_ratio FROM non_performing_loans WHERE provision_coverage_ratio > 150;
SELECT * FROM related_party_transactions WHERE transaction_date = '2023-12-22';
SELECT fi.institution_name FROM financial_institution_info fi JOIN liquidity_ratio lr ON fi.institution_id = lr.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id AND lr.report_date = npl.report_date WHERE lr.liquidity_coverage_ratio > 110 AND npl.npl_ratio < 1.5;
SELECT DISTINCT rr.institution_id FROM regulatory_reports rr JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id AND rr.report_date = npl.report_date WHERE YEAR(rr.report_date) = 2023 AND rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND npl.npl_ratio > 2;
SELECT institution_id FROM income_statement WHERE report_date >= DATE_SUB(CURDATE(), INTERVAL 2 YEAR) GROUP BY institution_id ORDER BY AVG(net_profit / (net_interest_income + non_interest_income)) DESC LIMIT 5;
SELECT institution_type, AVG(npl_ratio) FROM financial_institution_info JOIN non_performing_loans ON financial_institution_info.institution_id = non_performing_loans.institution_id WHERE YEAR(report_date) = 2023 GROUP BY institution_type;
SELECT COUNT(DISTINCT re.institution_id) FROM risk_exposure re JOIN capital_adequacy_ratio car ON re.institution_id = car.institution_id AND re.report_date = car.report_date WHERE (re.market_risk_exposure - LAG(re.market_risk_exposure) OVER (PARTITION BY re.institution_id ORDER BY re.report_date)) / LAG(re.market_risk_exposure) OVER (PARTITION BY re.institution_id ORDER BY re.report_date) > 0.5 AND (car.total_car - LAG(car.total_car) OVER (PARTITION BY car.institution_id ORDER BY car.report_date)) < 1;
SELECT total_assets, total_liabilities FROM balance_sheet;
SELECT DISTINCT f.institution_name FROM financial_institution_info f JOIN regulatory_reports r ON f.institution_id = r.institution_id JOIN related_party_transactions t ON f.institution_id = t.institution_id WHERE r.report_date >= '2023-07-01' AND r.report_date < '2023-08-01' AND r.approval_status = '需修改' AND t.transaction_amount > 5000000;
SELECT AVG(c.total_car) FROM balance_sheet b JOIN capital_adequacy_ratio c ON b.institution_id = c.institution_id WHERE b.total_assets > 1000000000000;
SELECT * FROM risk_exposure WHERE report_date = '2023-10-01';
SELECT fi.institution_name FROM financial_institution_info fi JOIN related_party_transactions rpt ON fi.institution_id = rpt.institution_id JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id WHERE rpt.transaction_date = '2023-06-01' AND rpt.transaction_amount > 5000000 AND rr.approval_status = '已批准';
SELECT bs.total_assets, car.total_car FROM balance_sheet bs JOIN capital_adequacy_ratio car ON bs.institution_id = car.institution_id AND bs.report_date = car.report_date;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM related_party_transactions WHERE YEAR(transaction_date) = 2023 GROUP BY institution_id HAVING SUM(CASE WHEN approval_status = '未通过' THEN 1 ELSE 0 END) / COUNT(*) > 0.2);
SELECT fi.institution_name FROM financial_institution_info fi JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE rr.report_date = '2023-07-01' AND rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND npl.npl_ratio > 2;
SELECT r.approval_status, c.compliance_type, c.description FROM regulatory_reports r JOIN compliance_records c ON r.institution_id = c.institution_id AND YEAR(r.report_date) = 2023 AND YEAR(c.record_date) = 2023;
SELECT fi.institution_name FROM financial_institution_info fi JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE rr.report_date = '2023-10-01' AND rr.report_type = '半年度报告' AND npl.npl_ratio > 2;
SELECT institution_id, liquidity_coverage_ratio, net_stable_funding_ratio FROM liquidity_ratio WHERE report_date = '2023-05-01';
SELECT institution_id, SUM(non_interest_income) FROM income_statement WHERE report_date = '2023-03-01' GROUP BY institution_id;
SELECT institution_id, report_date, credit_risk_exposure, market_risk_exposure, operational_risk_exposure, total_risk_exposure FROM risk_exposure WHERE report_date = '2023-02-01';
SELECT COUNT(*) FROM related_party_transactions WHERE YEAR(transaction_date) = 2023 AND transaction_amount > 500000000 AND transaction_type = '资产转移';
SELECT DISTINCT fii.institution_name FROM financial_institution_info fii JOIN regulatory_reports rr ON fii.institution_id = rr.institution_id JOIN related_party_transactions rpt ON fii.institution_id = rpt.institution_id WHERE rr.report_date = '2023-08-01' AND rr.approval_status = '需修改' AND rpt.transaction_amount > 5000000;
SELECT DISTINCT rr.institution_id FROM regulatory_reports rr JOIN income_statement is ON rr.institution_id = is.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '已拒绝' AND YEAR(rr.report_date) = 2023 AND is.report_date BETWEEN '2023-01-01' AND '2023-03-31' AND is.net_profit > 10000000;
SELECT fi.institution_name FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE rr.report_date = '2023-07-01' AND rr.approval_status = '需要修改';
SELECT * FROM compliance_records WHERE compliance_type = '内控管理';
SELECT DISTINCT r.institution_id FROM regulatory_reports r JOIN non_performing_loans n ON r.institution_id = n.institution_id AND r.report_date = n.report_date WHERE r.report_date = '2023-10-01' AND r.report_type = '半年度报告' AND r.approval_status = '待审核' AND n.npl_ratio > 1;
SELECT institution_type, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY npl_ratio) AS median_npl_ratio FROM financial_institution_info JOIN non_performing_loans ON financial_institution_info.institution_id = non_performing_loans.institution_id GROUP BY institution_type;
SELECT * FROM capital_adequacy_ratio WHERE core_tier_1_ratio < 8;
SELECT fi.institution_name FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE YEAR(rr.report_date) = 2023 AND rr.report_type = '半年度报告' AND rr.approval_status = '待审核' AND fi.registered_capital > 50000000;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM related_party_transactions WHERE transaction_date = '2023-06-01' AND transaction_amount > 5000000 AND approval_status = '待审批');
SELECT institution_id FROM liquidity_ratio WHERE loan_to_deposit_ratio > (SELECT AVG(loan_to_deposit_ratio) FROM liquidity_ratio) AND liquidity_coverage_ratio < (SELECT AVG(liquidity_coverage_ratio) FROM liquidity_ratio);
SELECT institution_id FROM income_statement WHERE report_date = '2023-04-01' AND net_interest_income > 1000000000;
SELECT DISTINCT rr.institution_id FROM regulatory_reports rr JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND YEAR(rr.report_date) = 2023 AND npl.npl_ratio > 1 AND YEAR(npl.report_date) = 2023;
SELECT fii.institution_name FROM financial_institution_info fii JOIN risk_exposure re ON fii.institution_id = re.institution_id JOIN capital_adequacy_ratio car ON fii.institution_id = car.institution_id WHERE re.report_date = '2023-10-01' AND re.total_risk_exposure > 3000 AND car.report_date = '2023-10-01' AND car.core_tier_1_ratio < 8;
SELECT COUNT(DISTINCT institution_id) FROM (SELECT institution_id, MAX(market_risk_exposure / credit_risk_exposure) AS max_ratio, MIN(market_risk_exposure / credit_risk_exposure) AS min_ratio FROM risk_exposure WHERE report_date >= DATEADD(YEAR, -1, GETDATE()) GROUP BY institution_id HAVING ABS(max_ratio - min_ratio) / min_ratio > 0.1) AS significant_change;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM balance_sheet WHERE loans_and_advances > deposits);
SELECT f.institution_name, r.report_date, r.approval_status FROM regulatory_reports r JOIN financial_institution_info f ON r.institution_id = f.institution_id WHERE r.report_type = '季度报告' AND r.approval_status = '已拒绝' AND YEAR(r.report_date) = 2023;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM income_statement WHERE report_date = '2023-04-01' AND non_interest_income > 200000000);
SELECT institution_id FROM related_party_transactions WHERE transaction_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY institution_id ORDER BY COUNT(*) DESC LIMIT 1;
SELECT institution_name, credit_risk_exposure / total_risk_exposure AS ratio FROM risk_exposure JOIN financial_institution_info ON risk_exposure.institution_id = financial_institution_info.institution_id ORDER BY ratio DESC LIMIT 1;
SELECT DISTINCT institution_id FROM risk_exposure WHERE YEAR(report_date) = 2023;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM capital_adequacy_ratio WHERE risk_weighted_assets > 120000000000 AND report_date = '2023-11-01');
SELECT severity, resolution_date FROM compliance_records WHERE severity IS NOT NULL AND resolution_date IS NOT NULL;
SELECT COUNT(DISTINCT institution_id) FROM liquidity_ratio WHERE liquidity_coverage_ratio > 100 AND net_stable_funding_ratio > 100;
SELECT AVG(npl.npl_ratio) AS avg_npl_ratio, AVG(npl.provision_coverage_ratio) AS avg_provision_coverage_ratio, AVG(car.total_car) AS avg_total_car FROM (SELECT institution_id FROM balance_sheet ORDER BY total_assets DESC LIMIT 1000) AS top_assets JOIN non_performing_loans AS npl ON top_assets.institution_id = npl.institution_id JOIN capital_adequacy_ratio AS car ON top_assets.institution_id = car.institution_id;
SELECT financial_institution_info.institution_name FROM financial_institution_info JOIN regulatory_reports ON financial_institution_info.institution_id = regulatory_reports.institution_id JOIN non_performing_loans ON financial_institution_info.institution_id = non_performing_loans.institution_id WHERE regulatory_reports.report_date = '2023-07-01' AND regulatory_reports.report_type = '季度报告' AND non_performing_loans.npl_ratio > 1.5;
SELECT fi.institution_name FROM financial_institution_info fi JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE rr.report_date = '2024-01-01' AND rr.report_type = '年度报告' AND rr.approval_status = '已批准' AND npl.npl_ratio > 1;
SELECT lr.liquidity_coverage_ratio, lr.net_stable_funding_ratio, lr.loan_to_deposit_ratio, bs.total_assets, bs.total_liabilities, bs.total_equity, bs.loans_and_advances, bs.deposits FROM liquidity_ratio lr JOIN balance_sheet bs ON lr.institution_id = bs.institution_id AND lr.report_date = bs.report_date;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM non_performing_loans WHERE report_date = '2023-12-01' AND npl_ratio > 1.5);
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM liquidity_ratio WHERE loan_to_deposit_ratio > 75 AND liquidity_coverage_ratio < 120);
SELECT * FROM regulatory_reports WHERE report_type = '半年度报告';
SELECT record_id FROM compliance_records ORDER BY (resolution_date - record_date) DESC LIMIT 5;
SELECT DISTINCT rr.institution_id FROM regulatory_reports rr JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '已拒绝' AND YEAR(rr.report_date) = 2023 AND npl.npl_ratio > 2 AND YEAR(npl.report_date) = 2023;
SELECT fi.institution_name, rr.report_id, rr.report_date, rr.comments FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '已拒绝' AND YEAR(rr.report_date) = 2023;
SELECT institution_id FROM liquidity_ratio WHERE loan_to_deposit_ratio BETWEEN 60 AND 80;
SELECT institution_name FROM financial_institution_info WHERE institution_id = (SELECT institution_id FROM capital_adequacy_ratio ORDER BY ABS(core_tier_1_ratio - total_car) ASC LIMIT 1);
SELECT bs.total_liabilities, fi.registered_capital FROM balance_sheet bs JOIN financial_institution_info fi ON bs.institution_id = fi.institution_id WHERE YEAR(bs.report_date) = 2024;
SELECT CORR(re.credit_risk_exposure, npl.npl_ratio) FROM risk_exposure re JOIN non_performing_loans npl ON re.institution_id = npl.institution_id AND re.report_date = npl.report_date;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT r.institution_id FROM regulatory_reports r JOIN capital_adequacy_ratio c ON r.institution_id = c.institution_id AND r.report_date = c.report_date WHERE r.report_date BETWEEN '2023-01-01' AND '2023-12-31' AND r.approval_status = '已批准' AND c.total_car > 10);
SELECT npl_ratio, institution_id FROM non_performing_loans WHERE report_date = '2023-06-01';
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM risk_exposure WHERE report_date = '2023-05-01' AND market_risk_exposure > 20000000000);
SELECT fi.institution_name, rr.report_date, rr.approval_status FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE YEAR(rr.report_date) = 2024 AND rr.report_type = '年度报告' AND rr.approval_status = '已批准';
SELECT * FROM capital_adequacy_ratio WHERE report_date = '2023-11-01';
SELECT lr.net_stable_funding_ratio, car.core_tier_1_ratio FROM liquidity_ratio lr JOIN capital_adequacy_ratio car ON lr.institution_id = car.institution_id AND lr.report_date = car.report_date;
SELECT fi.institution_name, rr.report_date FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE rr.report_type = '年度报告' AND rr.approval_status = '已批准' AND YEAR(rr.report_date) = 2024;
SELECT * FROM capital_adequacy_ratio WHERE report_date = '2023-11-01';
SELECT * FROM capital_adequacy_ratio WHERE institution_id = 2162;
SELECT total_loans, npl_amount FROM non_performing_loans WHERE YEAR(report_date) = 2023;
SELECT (re.market_risk_exposure / re.total_risk_exposure) AS market_risk_ratio, (is.non_interest_income / (is.net_interest_income + is.non_interest_income)) AS transaction_income_ratio FROM risk_exposure re JOIN income_statement is ON re.institution_id = is.institution_id AND re.report_date = is.report_date;
SELECT institution_name FROM financial_institution_info WHERE institution_id = (SELECT income_statement.institution_id FROM income_statement JOIN non_performing_loans ON income_statement.institution_id = non_performing_loans.institution_id AND income_statement.report_date = non_performing_loans.report_date ORDER BY (income_statement.provision_for_loan_losses / non_performing_loans.npl_amount) DESC LIMIT 1);
SELECT institution_id, report_date, liquidity_coverage_ratio, net_stable_funding_ratio, loan_to_deposit_ratio FROM liquidity_ratio WHERE YEAR(report_date) = 2023 UNION SELECT institution_id, report_date, core_tier_1_ratio, tier_1_ratio, total_car FROM capital_adequacy_ratio WHERE YEAR(report_date) = 2023;
SELECT institution_name FROM financial_institution_info JOIN income_statement ON financial_institution_info.institution_id = income_statement.institution_id WHERE report_date = '2023-04-01' ORDER BY operating_expenses DESC LIMIT 1;
SELECT institution_id, non_interest_income, net_profit FROM income_statement WHERE YEAR(report_date) = 2023;
SELECT DISTINCT rr.institution_id FROM regulatory_reports rr JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id AND YEAR(rr.report_date) = 2023 AND YEAR(npl.report_date) = 2023 WHERE rr.report_type = '季度报告' AND rr.approval_status = '已拒绝' AND npl.npl_ratio > 2;
SELECT institution_id FROM capital_adequacy_ratio WHERE report_date = '2023-12-01' AND core_tier_1_ratio < 9;
SELECT institution_id FROM liquidity_ratio WHERE report_date = '2023-11-01' AND liquidity_coverage_ratio < 110;
SELECT re.market_risk_exposure, npl.provision_coverage_ratio FROM risk_exposure re JOIN non_performing_loans npl ON re.institution_id = npl.institution_id AND re.report_date = npl.report_date WHERE re.report_date = '2023-03-01';
SELECT legal_representative, contact_number FROM financial_institution_info;
SELECT institution_id FROM related_party_transactions WHERE YEAR(transaction_date) = 2023 GROUP BY institution_id ORDER BY COUNT(DISTINCT related_party) DESC LIMIT 1;
SELECT address FROM financial_institution_info JOIN liquidity_ratio ON financial_institution_info.institution_id = liquidity_ratio.institution_id GROUP BY address ORDER BY AVG(liquidity_coverage_ratio) DESC LIMIT 1;
SELECT QUARTER(report_date) AS quarter, AVG(LENGTH(comments)) AS avg_word_count FROM regulatory_reports WHERE YEAR(report_date) = 2023 GROUP BY QUARTER(report_date);
SELECT fi.institution_name, npl.provision_coverage_ratio FROM non_performing_loans npl JOIN financial_institution_info fi ON npl.institution_id = fi.institution_id ORDER BY npl.provision_coverage_ratio DESC LIMIT 1;
SELECT legal_representative, contact_number FROM financial_institution_info;
SELECT fi.institution_name, rr.report_date, rr.submission_date FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND YEAR(rr.report_date) = 2023;
SELECT fi.institution_name FROM financial_institution_info fi JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE car.total_car > 12 AND npl.npl_ratio < 2;
SELECT fi.institution_name FROM liquidity_ratio lr JOIN financial_institution_info fi ON lr.institution_id = fi.institution_id WHERE lr.net_stable_funding_ratio > 100 AND lr.loan_to_deposit_ratio < 75 LIMIT 10;
SELECT institution_id FROM risk_exposure WHERE YEAR(report_date) = 2023 AND credit_risk_exposure > 50000000000;
SELECT institution_id FROM non_performing_loans WHERE npl_ratio > 2;
SELECT * FROM capital_adequacy_ratio WHERE report_date = '2023-05-01';
SELECT institution_id, severity, COUNT(*) FROM compliance_records WHERE YEAR(record_date) = 2023 GROUP BY institution_id, severity;
SELECT fi.institution_name, rr.report_date, rr.comments FROM regulatory_reports rr INNER JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE YEAR(rr.report_date) = 2023 AND rr.report_type = '季度报告' AND rr.approval_status = '已拒绝';
SELECT related_party, transaction_amount FROM related_party_transactions;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT r.institution_id FROM regulatory_reports r JOIN related_party_transactions t ON r.institution_id = t.institution_id WHERE r.report_date = '2023-10-01' AND r.report_type = '半年度报告' GROUP BY r.institution_id HAVING SUM(t.transaction_amount) > 10000000);
SELECT fi.institution_name, rr.report_id, rr.report_date, rr.comments FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '已拒绝' AND YEAR(rr.report_date) = 2023;
SELECT fi.institution_name, rr.report_type, rr.approval_status, rr.submission_date FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE YEAR(rr.report_date) = 2023 AND rr.report_type = '季度报告' AND rr.approval_status = '已拒绝';
SELECT npl.npl_ratio, fi.address FROM non_performing_loans npl JOIN financial_institution_info fi ON npl.institution_id = fi.institution_id;
SELECT report_type, approval_status FROM regulatory_reports WHERE YEAR(report_date) = 2024;
SELECT institution_type, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY liquidity_coverage_ratio) AS median_liquidity_coverage_ratio FROM financial_institution_info JOIN liquidity_ratio ON financial_institution_info.institution_id = liquidity_ratio.institution_id GROUP BY institution_type;
SELECT DISTINCT rr.institution_id FROM regulatory_reports rr JOIN capital_adequacy_ratio car ON rr.institution_id = car.institution_id WHERE rr.report_date >= '2023-01-01' AND rr.report_date <= '2023-12-31' AND rr.report_type = '季度报告' AND rr.approval_status = '已拒绝' AND car.report_date = '2023-06-01' AND car.core_tier_1_ratio < 8;
SELECT AVG(npl.npl_ratio) FROM capital_adequacy_ratio car JOIN non_performing_loans npl ON car.institution_id = npl.institution_id WHERE car.report_date BETWEEN '2023-07-01' AND '2023-09-30' AND npl.report_date BETWEEN '2023-07-01' AND '2023-09-30' ORDER BY car.total_car DESC LIMIT 10;
SELECT institution_name FROM compliance_records JOIN financial_institution_info ON compliance_records.institution_id = financial_institution_info.institution_id WHERE status != '已解决' GROUP BY compliance_records.institution_id ORDER BY COUNT(*) DESC LIMIT 1;
SELECT * FROM related_party_transactions WHERE YEAR(transaction_date) = 2023 AND transaction_amount > 5000000;
SELECT institution_id FROM risk_exposure WHERE (market_risk_exposure / total_risk_exposure) > 0.25;
SELECT fi.institution_name, rpt.transaction_amount, rpt.transaction_type FROM related_party_transactions rpt JOIN financial_institution_info fi ON rpt.institution_id = fi.institution_id WHERE rpt.transaction_date >= '2023-08-01' AND rpt.transaction_date <= '2023-08-31' AND rpt.transaction_amount > 5000000 AND rpt.approval_status = '待审批';
SELECT DISTINCT fii.institution_name FROM regulatory_reports rr JOIN income_statement is ON rr.institution_id = is.institution_id JOIN financial_institution_info fii ON rr.institution_id = fii.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND YEAR(rr.report_date) = 2023 AND YEAR(is.report_date) = 2023 AND QUARTER(is.report_date) = 1 AND is.net_profit > 50000000;
SELECT institution_id FROM non_performing_loans WHERE npl_ratio > (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY npl_ratio) FROM non_performing_loans) AND provision_coverage_ratio > (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY provision_coverage_ratio) FROM non_performing_loans) AND institution_id IN (SELECT institution_id FROM capital_adequacy_ratio WHERE total_car > (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY total_car) FROM capital_adequacy_ratio));
SELECT related_party FROM related_party_transactions ORDER BY transaction_amount DESC LIMIT 1;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM regulatory_reports WHERE report_date = '2023-10-01' AND approval_status = '待审批');
SELECT institution_id FROM risk_exposure WHERE report_date = '2023-05-01' AND total_risk_exposure > 15000000000;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM regulatory_reports WHERE YEAR(report_date) = 2023 AND report_type = '季度报告' AND approval_status = '需修改') AND registered_capital > 50000000;
SELECT market_risk_exposure, credit_risk_exposure FROM risk_exposure WHERE report_date >= '2023-11-01' AND report_date < '2023-12-01';
SELECT institution_id, total_risk_exposure, credit_risk_exposure FROM risk_exposure WHERE report_date = '2023-09-01';
SELECT DISTINCT fii.institution_name FROM related_party_transactions rpt JOIN financial_institution_info fii ON rpt.institution_id = fii.institution_id WHERE rpt.transaction_date >= '2023-05-01' AND rpt.transaction_date <= '2023-05-31' AND rpt.transaction_amount > 5000000 AND rpt.approval_status = '已批准';
SELECT institution_id FROM capital_adequacy_ratio WHERE risk_weighted_assets > 8000;
SELECT COUNT(DISTINCT fi.institution_id) FROM financial_institution_info fi INNER JOIN balance_sheet bs ON fi.institution_id = bs.institution_id WHERE fi.registered_capital < 1000000000 AND bs.total_assets > 100000000000;
SELECT fi.institution_name FROM financial_institution_info fi JOIN capital_adequacy_ratio car ON fi.institution_id = car.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE car.total_car < 12 AND npl.npl_ratio > 2 AND car.report_date BETWEEN '2023-07-01' AND '2023-09-30' AND npl.report_date BETWEEN '2023-07-01' AND '2023-09-30';
SELECT report_date, approval_status FROM regulatory_reports;
SELECT institution_name FROM financial_institution_info WHERE institution_id = (SELECT institution_id FROM balance_sheet WHERE YEAR(report_date) = 2024 ORDER BY total_assets DESC LIMIT 1);
SELECT compliance_type FROM compliance_records WHERE severity = '严重' AND record_date >= '2023-01-01' AND record_date <= '2023-12-31' GROUP BY compliance_type ORDER BY AVG(resolution_date - record_date) DESC LIMIT 1;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT r.institution_id FROM regulatory_reports r JOIN related_party_transactions t ON r.institution_id = t.institution_id WHERE r.report_date = '2023-10-01' AND r.report_type = '半年度报告' AND t.transaction_amount > 5000000);
SELECT AVG(non_interest_income) FROM income_statement WHERE report_date = '2023-01-01';
SELECT npl_amount FROM non_performing_loans WHERE report_date = '2023-06';
SELECT institution_id FROM non_performing_loans WHERE provision_coverage_ratio < 200;
SELECT AVG(c.total_car) FROM (SELECT i.institution_id FROM income_statement i WHERE i.report_date >= '2023-10-01' AND i.report_date <= '2023-12-31' ORDER BY i.net_profit DESC LIMIT 10) AS top_institutions JOIN capital_adequacy_ratio c ON top_institutions.institution_id = c.institution_id WHERE c.report_date >= '2023-10-01' AND c.report_date <= '2023-12-31';
SELECT institution_id FROM compliance_records WHERE description LIKE '%客户投诉%';
SELECT net_interest_income, non_interest_income FROM income_statement WHERE report_date = '2023-07-01';
SELECT DISTINCT rr.institution_id FROM regulatory_reports rr JOIN non_performing_loans npl ON rr.institution_id = npl.institution_id WHERE rr.report_type = '季度报告' AND rr.approval_status = '已拒绝' AND YEAR(rr.report_date) = 2023 AND npl.npl_ratio > 1 AND YEAR(npl.report_date) = 2023;
SELECT npl_amount, provision_coverage_ratio FROM non_performing_loans WHERE report_date = '2023-03-01';
SELECT b.total_assets, c.total_car, l.liquidity_coverage_ratio FROM balance_sheet b JOIN capital_adequacy_ratio c ON b.institution_id = c.institution_id AND b.report_date = c.report_date JOIN liquidity_ratio l ON b.institution_id = l.institution_id AND b.report_date = l.report_date;
SELECT institution_id FROM regulatory_reports WHERE YEAR(report_date) = 2023 AND approval_status = '已拒绝';
SELECT COUNT(DISTINCT n1.institution_id) FROM non_performing_loans n1 JOIN non_performing_loans n2 ON n1.institution_id = n2.institution_id AND YEAR(n1.report_date) = YEAR(n2.report_date) - 1 AND n1.total_loans * 1.2 < n2.total_loans JOIN capital_adequacy_ratio c1 ON n1.institution_id = c1.institution_id JOIN capital_adequacy_ratio c2 ON c1.institution_id = c2.institution_id AND YEAR(c1.report_date) = YEAR(c2.report_date) - 1 AND c1.total_car > c2.total_car;
SELECT institution_id FROM regulatory_reports WHERE report_type = '季度报告' AND approval_status = '需修改' AND report_date >= '2023-07-01' AND report_date <= '2023-09-30';
SELECT fi.institution_name FROM financial_institution_info fi JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE rr.report_date = '2023-07-01' AND rr.report_type = '季度报告' AND npl.npl_ratio > 1;
SELECT DISTINCT institution_name FROM related_party_transactions JOIN financial_institution_info ON related_party_transactions.institution_id = financial_institution_info.institution_id WHERE transaction_date >= '2023-10-01' AND transaction_date <= '2023-10-31';
SELECT fi.institution_name FROM financial_institution_info fi JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id JOIN non_performing_loans npl ON fi.institution_id = npl.institution_id WHERE rr.report_date = '2023-07-01' AND rr.report_type = '季度报告' AND npl.npl_ratio > 2;
SELECT report_date, risk_weighted_assets, total_car FROM capital_adequacy_ratio ORDER BY report_date;
SELECT lr.institution_id, lr.liquidity_coverage_ratio, rr.approval_status FROM liquidity_ratio lr JOIN regulatory_reports rr ON lr.institution_id = rr.institution_id AND lr.report_date = rr.report_date WHERE YEAR(lr.report_date) = 2023;
SELECT fi.institution_name, rr.report_date, rr.approval_status FROM financial_institution_info fi JOIN regulatory_reports rr ON fi.institution_id = rr.institution_id WHERE rr.report_date > '2023-07-01' AND rr.approval_status = '需修改';
SELECT COUNT(*) FROM regulatory_reports WHERE report_date BETWEEN '2023-04-01' AND '2023-06-30' AND approval_status = '拒绝';
SELECT credit_risk_exposure, market_risk_exposure, operational_risk_exposure, total_risk_exposure FROM risk_exposure WHERE report_date = '2023-10-01';
SELECT fi.institution_name, (bs2.loans_and_advances - bs1.loans_and_advances) / bs1.loans_and_advances AS growth_rate FROM balance_sheet bs1 JOIN balance_sheet bs2 ON bs1.institution_id = bs2.institution_id AND bs1.report_date < bs2.report_date JOIN financial_institution_info fi ON bs1.institution_id = fi.institution_id ORDER BY growth_rate DESC LIMIT 1;
SELECT fi.institution_name FROM risk_exposure re JOIN financial_institution_info fi ON re.institution_id = fi.institution_id WHERE YEAR(re.report_date) = 2023 AND re.market_risk_exposure / re.total_risk_exposure > 0.15;
SELECT fi.institution_name, rr.report_type, rr.submission_date FROM regulatory_reports rr JOIN financial_institution_info fi ON rr.institution_id = fi.institution_id WHERE YEAR(rr.submission_date) = 2023 AND rr.approval_status = '需修改' ORDER BY rr.submission_date DESC;
SELECT DISTINCT rr.institution_id FROM regulatory_reports rr JOIN related_party_transactions rpt ON rr.institution_id = rpt.institution_id WHERE YEAR(rr.report_date) = 2023 AND rr.report_type = '季度报告' AND rr.approval_status = '需修改' AND YEAR(rpt.transaction_date) = 2023 AND rpt.transaction_amount > 10000000;
SELECT lr.liquidity_coverage_ratio, fii.institution_type FROM liquidity_ratio lr JOIN financial_institution_info fii ON lr.institution_id = fii.institution_id;
SELECT institution_name FROM financial_institution_info WHERE institution_id IN (SELECT institution_id FROM related_party_transactions WHERE transaction_date >= '2023-10-01' AND transaction_date < '2023-11-01' AND transaction_amount > 10000000);
SELECT institution_id FROM related_party_transactions WHERE transaction_date >= '2023-01-01' GROUP BY institution_id ORDER BY COUNT(CASE WHEN approval_status = '未通过' THEN 1 END) / COUNT(*) DESC LIMIT 1;
SELECT institution_id FROM risk_exposure WHERE YEAR(report_date) = 2023 ORDER BY operational_risk_exposure / total_risk_exposure DESC LIMIT 1;
SELECT DISTINCT institution_id FROM regulatory_reports WHERE report_type = '年度报告' AND YEAR(report_date) = 2023 AND comments IS NOT NULL;
SELECT npl.total_loans, npl.npl_amount, npl.npl_ratio, npl.provision_coverage_ratio, fi.institution_name FROM non_performing_loans npl JOIN financial_institution_info fi ON npl.institution_id = fi.institution_id WHERE npl.report_date = '2023-03-01';
SELECT institution_name FROM financial_institution_info WHERE legal_representative LIKE '王%';
SELECT DISTINCT fii.institution_name FROM financial_institution_info fii JOIN regulatory_reports rr ON fii.institution_id = rr.institution_id JOIN capital_adequacy_ratio car ON fii.institution_id = car.institution_id WHERE rr.report_date BETWEEN '2023-01-01' AND '2023-03-31' AND rr.report_type = '资本充足率' AND car.total_car > 10;